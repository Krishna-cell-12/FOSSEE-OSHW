{
  "version": 3,
  "sources": ["../../avr8js/dist/esm/cpu/interrupt.js", "../../avr8js/dist/esm/cpu/cpu.js", "../../avr8js/dist/esm/cpu/instruction.js", "../../avr8js/dist/esm/peripherals/adc.js", "../../avr8js/dist/esm/peripherals/clock.js", "../../avr8js/dist/esm/peripherals/eeprom.js", "../../avr8js/dist/esm/peripherals/gpio.js", "../../avr8js/dist/esm/peripherals/spi.js", "../../avr8js/dist/esm/peripherals/timer.js", "../../avr8js/dist/esm/peripherals/twi.js", "../../avr8js/dist/esm/peripherals/usart.js", "../../avr8js/dist/esm/peripherals/usi.js", "../../avr8js/dist/esm/peripherals/watchdog.js"],
  "sourcesContent": ["/**\r\n * AVR-8 Interrupt Handling\r\n * Part of AVR8js\r\n * Reference: http://ww1.microchip.com/downloads/en/devicedoc/atmel-0856-avr-instruction-set-manual.pdf\r\n *\r\n * Copyright (C) 2019, Uri Shaked\r\n */\r\nexport function avrInterrupt(cpu, addr) {\r\n    const sp = cpu.dataView.getUint16(93, true);\r\n    cpu.data[sp] = cpu.pc & 0xff;\r\n    cpu.data[sp - 1] = (cpu.pc >> 8) & 0xff;\r\n    if (cpu.pc22Bits) {\r\n        cpu.data[sp - 2] = (cpu.pc >> 16) & 0xff;\r\n    }\r\n    cpu.dataView.setUint16(93, sp - (cpu.pc22Bits ? 3 : 2), true);\r\n    cpu.data[95] &= 0x7f; // clear global interrupt flag\r\n    cpu.cycles += 2;\r\n    cpu.pc = addr;\r\n}\r\n", "/**\r\n * AVR 8 CPU data structures\r\n * Part of AVR8js\r\n *\r\n * Copyright (C) 2019, Uri Shaked\r\n */\r\nimport { avrInterrupt } from './interrupt';\r\nconst registerSpace = 0x100;\r\nconst MAX_INTERRUPTS = 128; // Enough for ATMega2560\r\nexport class CPU {\r\n    constructor(progMem, sramBytes = 8192) {\r\n        this.progMem = progMem;\r\n        this.sramBytes = sramBytes;\r\n        this.data = new Uint8Array(this.sramBytes + registerSpace);\r\n        this.data16 = new Uint16Array(this.data.buffer);\r\n        this.dataView = new DataView(this.data.buffer);\r\n        this.progBytes = new Uint8Array(this.progMem.buffer);\r\n        this.readHooks = [];\r\n        this.writeHooks = [];\r\n        this.pendingInterrupts = new Array(MAX_INTERRUPTS);\r\n        this.nextClockEvent = null;\r\n        this.clockEventPool = []; // helps avoid garbage collection\r\n        /**\r\n         * Whether the program counter (PC) can address 22 bits (the default is 16)\r\n         */\r\n        this.pc22Bits = this.progBytes.length > 0x20000;\r\n        this.gpioPorts = new Set();\r\n        this.gpioByPort = [];\r\n        /**\r\n         * This function is called by the WDR instruction. The Watchdog peripheral attaches\r\n         * to it to listen for WDR (watchdog reset).\r\n         */\r\n        this.onWatchdogReset = () => {\r\n            /* empty by default */\r\n        };\r\n        /**\r\n         * Program counter\r\n         */\r\n        this.pc = 0;\r\n        /**\r\n         * Clock cycle counter\r\n         */\r\n        this.cycles = 0;\r\n        this.nextInterrupt = -1;\r\n        this.maxInterrupt = 0;\r\n        this.reset();\r\n    }\r\n    reset() {\r\n        this.SP = this.data.length - 1;\r\n        this.pc = 0;\r\n        this.pendingInterrupts.fill(null);\r\n        this.nextInterrupt = -1;\r\n        this.nextClockEvent = null;\r\n    }\r\n    readData(addr) {\r\n        if (addr >= 32 && this.readHooks[addr]) {\r\n            return this.readHooks[addr](addr);\r\n        }\r\n        return this.data[addr];\r\n    }\r\n    writeData(addr, value, mask = 0xff) {\r\n        const hook = this.writeHooks[addr];\r\n        if (hook) {\r\n            if (hook(value, this.data[addr], addr, mask)) {\r\n                return;\r\n            }\r\n        }\r\n        this.data[addr] = value;\r\n    }\r\n    get SP() {\r\n        return this.dataView.getUint16(93, true);\r\n    }\r\n    set SP(value) {\r\n        this.dataView.setUint16(93, value, true);\r\n    }\r\n    get SREG() {\r\n        return this.data[95];\r\n    }\r\n    get interruptsEnabled() {\r\n        return this.SREG & 0x80 ? true : false;\r\n    }\r\n    setInterruptFlag(interrupt) {\r\n        const { flagRegister, flagMask, enableRegister, enableMask } = interrupt;\r\n        if (interrupt.inverseFlag) {\r\n            this.data[flagRegister] &= ~flagMask;\r\n        }\r\n        else {\r\n            this.data[flagRegister] |= flagMask;\r\n        }\r\n        if (this.data[enableRegister] & enableMask) {\r\n            this.queueInterrupt(interrupt);\r\n        }\r\n    }\r\n    updateInterruptEnable(interrupt, registerValue) {\r\n        const { enableMask, flagRegister, flagMask, inverseFlag } = interrupt;\r\n        if (registerValue & enableMask) {\r\n            const bitSet = this.data[flagRegister] & flagMask;\r\n            if (inverseFlag ? !bitSet : bitSet) {\r\n                this.queueInterrupt(interrupt);\r\n            }\r\n        }\r\n        else {\r\n            this.clearInterrupt(interrupt, false);\r\n        }\r\n    }\r\n    queueInterrupt(interrupt) {\r\n        const { address } = interrupt;\r\n        this.pendingInterrupts[address] = interrupt;\r\n        if (this.nextInterrupt === -1 || this.nextInterrupt > address) {\r\n            this.nextInterrupt = address;\r\n        }\r\n        if (address > this.maxInterrupt) {\r\n            this.maxInterrupt = address;\r\n        }\r\n    }\r\n    clearInterrupt({ address, flagRegister, flagMask }, clearFlag = true) {\r\n        if (clearFlag) {\r\n            this.data[flagRegister] &= ~flagMask;\r\n        }\r\n        const { pendingInterrupts, maxInterrupt } = this;\r\n        if (!pendingInterrupts[address]) {\r\n            return;\r\n        }\r\n        pendingInterrupts[address] = null;\r\n        if (this.nextInterrupt === address) {\r\n            this.nextInterrupt = -1;\r\n            for (let i = address + 1; i <= maxInterrupt; i++) {\r\n                if (pendingInterrupts[i]) {\r\n                    this.nextInterrupt = i;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    clearInterruptByFlag(interrupt, registerValue) {\r\n        const { flagRegister, flagMask } = interrupt;\r\n        if (registerValue & flagMask) {\r\n            this.data[flagRegister] &= ~flagMask;\r\n            this.clearInterrupt(interrupt);\r\n        }\r\n    }\r\n    addClockEvent(callback, cycles) {\r\n        const { clockEventPool } = this;\r\n        cycles = this.cycles + Math.max(1, cycles);\r\n        const maybeEntry = clockEventPool.pop();\r\n        const entry = maybeEntry !== null && maybeEntry !== void 0 ? maybeEntry : { cycles, callback, next: null };\r\n        entry.cycles = cycles;\r\n        entry.callback = callback;\r\n        let { nextClockEvent: clockEvent } = this;\r\n        let lastItem = null;\r\n        while (clockEvent && clockEvent.cycles < cycles) {\r\n            lastItem = clockEvent;\r\n            clockEvent = clockEvent.next;\r\n        }\r\n        if (lastItem) {\r\n            lastItem.next = entry;\r\n            entry.next = clockEvent;\r\n        }\r\n        else {\r\n            this.nextClockEvent = entry;\r\n            entry.next = clockEvent;\r\n        }\r\n        return callback;\r\n    }\r\n    updateClockEvent(callback, cycles) {\r\n        if (this.clearClockEvent(callback)) {\r\n            this.addClockEvent(callback, cycles);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    clearClockEvent(callback) {\r\n        let { nextClockEvent: clockEvent } = this;\r\n        if (!clockEvent) {\r\n            return false;\r\n        }\r\n        const { clockEventPool } = this;\r\n        let lastItem = null;\r\n        while (clockEvent) {\r\n            if (clockEvent.callback === callback) {\r\n                if (lastItem) {\r\n                    lastItem.next = clockEvent.next;\r\n                }\r\n                else {\r\n                    this.nextClockEvent = clockEvent.next;\r\n                }\r\n                if (clockEventPool.length < 10) {\r\n                    clockEventPool.push(clockEvent);\r\n                }\r\n                return true;\r\n            }\r\n            lastItem = clockEvent;\r\n            clockEvent = clockEvent.next;\r\n        }\r\n        return false;\r\n    }\r\n    tick() {\r\n        const { nextClockEvent } = this;\r\n        if (nextClockEvent && nextClockEvent.cycles <= this.cycles) {\r\n            nextClockEvent.callback();\r\n            this.nextClockEvent = nextClockEvent.next;\r\n            if (this.clockEventPool.length < 10) {\r\n                this.clockEventPool.push(nextClockEvent);\r\n            }\r\n        }\r\n        const { nextInterrupt } = this;\r\n        if (this.interruptsEnabled && nextInterrupt >= 0) {\r\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n            const interrupt = this.pendingInterrupts[nextInterrupt];\r\n            avrInterrupt(this, interrupt.address);\r\n            if (!interrupt.constant) {\r\n                this.clearInterrupt(interrupt);\r\n            }\r\n        }\r\n    }\r\n}\r\n", "/**\r\n * AVR-8 Instruction Simulation\r\n * Part of AVR8js\r\n *\r\n * Reference: http://ww1.microchip.com/downloads/en/devicedoc/atmel-0856-avr-instruction-set-manual.pdf\r\n *\r\n * Instruction timing is currently based on ATmega328p (see the Instruction Set Summary at the end of\r\n * the datasheet)\r\n *\r\n * Copyright (C) 2019, 2020 Uri Shaked\r\n */\r\nfunction isTwoWordInstruction(opcode) {\r\n    return (\r\n    /* LDS */\r\n    (opcode & 0xfe0f) === 0x9000 ||\r\n        /* STS */\r\n        (opcode & 0xfe0f) === 0x9200 ||\r\n        /* CALL */\r\n        (opcode & 0xfe0e) === 0x940e ||\r\n        /* JMP */\r\n        (opcode & 0xfe0e) === 0x940c);\r\n}\r\nexport function avrInstruction(cpu) {\r\n    const opcode = cpu.progMem[cpu.pc];\r\n    if ((opcode & 0xfc00) === 0x1c00) {\r\n        /* ADC, 0001 11rd dddd rrrr */\r\n        const d = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const r = cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)];\r\n        const sum = d + r + (cpu.data[95] & 1);\r\n        const R = sum & 255;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = R;\r\n        let sreg = cpu.data[95] & 0xc0;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= (R ^ r) & (d ^ R) & 128 ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= sum & 256 ? 1 : 0;\r\n        sreg |= 1 & ((d & r) | (r & ~R) | (~R & d)) ? 0x20 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xfc00) === 0xc00) {\r\n        /* ADD, 0000 11rd dddd rrrr */\r\n        const d = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const r = cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)];\r\n        const R = (d + r) & 255;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = R;\r\n        let sreg = cpu.data[95] & 0xc0;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= (R ^ r) & (R ^ d) & 128 ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= (d + r) & 256 ? 1 : 0;\r\n        sreg |= 1 & ((d & r) | (r & ~R) | (~R & d)) ? 0x20 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xff00) === 0x9600) {\r\n        /* ADIW, 1001 0110 KKdd KKKK */\r\n        const addr = 2 * ((opcode & 0x30) >> 4) + 24;\r\n        const value = cpu.dataView.getUint16(addr, true);\r\n        const R = (value + ((opcode & 0xf) | ((opcode & 0xc0) >> 2))) & 0xffff;\r\n        cpu.dataView.setUint16(addr, R, true);\r\n        let sreg = cpu.data[95] & 0xe0;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 0x8000 & R ? 4 : 0;\r\n        sreg |= ~value & R & 0x8000 ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= ~R & value & 0x8000 ? 1 : 0;\r\n        cpu.data[95] = sreg;\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfc00) === 0x2000) {\r\n        /* AND, 0010 00rd dddd rrrr */\r\n        const R = cpu.data[(opcode & 0x1f0) >> 4] & cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)];\r\n        cpu.data[(opcode & 0x1f0) >> 4] = R;\r\n        let sreg = cpu.data[95] & 0xe1;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xf000) === 0x7000) {\r\n        /* ANDI, 0111 KKKK dddd KKKK */\r\n        const R = cpu.data[((opcode & 0xf0) >> 4) + 16] & ((opcode & 0xf) | ((opcode & 0xf00) >> 4));\r\n        cpu.data[((opcode & 0xf0) >> 4) + 16] = R;\r\n        let sreg = cpu.data[95] & 0xe1;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9405) {\r\n        /* ASR, 1001 010d dddd 0101 */\r\n        const value = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const R = (value >>> 1) | (128 & value);\r\n        cpu.data[(opcode & 0x1f0) >> 4] = R;\r\n        let sreg = cpu.data[95] & 0xe0;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= value & 1;\r\n        sreg |= ((sreg >> 2) & 1) ^ (sreg & 1) ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xff8f) === 0x9488) {\r\n        /* BCLR, 1001 0100 1sss 1000 */\r\n        cpu.data[95] &= ~(1 << ((opcode & 0x70) >> 4));\r\n    }\r\n    else if ((opcode & 0xfe08) === 0xf800) {\r\n        /* BLD, 1111 100d dddd 0bbb */\r\n        const b = opcode & 7;\r\n        const d = (opcode & 0x1f0) >> 4;\r\n        cpu.data[d] = (~(1 << b) & cpu.data[d]) | (((cpu.data[95] >> 6) & 1) << b);\r\n    }\r\n    else if ((opcode & 0xfc00) === 0xf400) {\r\n        /* BRBC, 1111 01kk kkkk ksss */\r\n        if (!(cpu.data[95] & (1 << (opcode & 7)))) {\r\n            cpu.pc = cpu.pc + (((opcode & 0x1f8) >> 3) - (opcode & 0x200 ? 0x40 : 0));\r\n            cpu.cycles++;\r\n        }\r\n    }\r\n    else if ((opcode & 0xfc00) === 0xf000) {\r\n        /* BRBS, 1111 00kk kkkk ksss */\r\n        if (cpu.data[95] & (1 << (opcode & 7))) {\r\n            cpu.pc = cpu.pc + (((opcode & 0x1f8) >> 3) - (opcode & 0x200 ? 0x40 : 0));\r\n            cpu.cycles++;\r\n        }\r\n    }\r\n    else if ((opcode & 0xff8f) === 0x9408) {\r\n        /* BSET, 1001 0100 0sss 1000 */\r\n        cpu.data[95] |= 1 << ((opcode & 0x70) >> 4);\r\n    }\r\n    else if ((opcode & 0xfe08) === 0xfa00) {\r\n        /* BST, 1111 101d dddd 0bbb */\r\n        const d = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const b = opcode & 7;\r\n        cpu.data[95] = (cpu.data[95] & 0xbf) | ((d >> b) & 1 ? 0x40 : 0);\r\n    }\r\n    else if ((opcode & 0xfe0e) === 0x940e) {\r\n        /* CALL, 1001 010k kkkk 111k kkkk kkkk kkkk kkkk */\r\n        const k = cpu.progMem[cpu.pc + 1] | ((opcode & 1) << 16) | ((opcode & 0x1f0) << 13);\r\n        const ret = cpu.pc + 2;\r\n        const sp = cpu.dataView.getUint16(93, true);\r\n        const { pc22Bits } = cpu;\r\n        cpu.data[sp] = 255 & ret;\r\n        cpu.data[sp - 1] = (ret >> 8) & 255;\r\n        if (pc22Bits) {\r\n            cpu.data[sp - 2] = (ret >> 16) & 255;\r\n        }\r\n        cpu.dataView.setUint16(93, sp - (pc22Bits ? 3 : 2), true);\r\n        cpu.pc = k - 1;\r\n        cpu.cycles += pc22Bits ? 4 : 3;\r\n    }\r\n    else if ((opcode & 0xff00) === 0x9800) {\r\n        /* CBI, 1001 1000 AAAA Abbb */\r\n        const A = opcode & 0xf8;\r\n        const b = opcode & 7;\r\n        const R = cpu.readData((A >> 3) + 32);\r\n        const mask = 1 << b;\r\n        cpu.writeData((A >> 3) + 32, R & ~mask, mask);\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9400) {\r\n        /* COM, 1001 010d dddd 0000 */\r\n        const d = (opcode & 0x1f0) >> 4;\r\n        const R = 255 - cpu.data[d];\r\n        cpu.data[d] = R;\r\n        let sreg = (cpu.data[95] & 0xe1) | 1;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xfc00) === 0x1400) {\r\n        /* CP, 0001 01rd dddd rrrr */\r\n        const val1 = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const val2 = cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)];\r\n        const R = val1 - val2;\r\n        let sreg = cpu.data[95] & 0xc0;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= 0 !== ((val1 ^ val2) & (val1 ^ R) & 128) ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= val2 > val1 ? 1 : 0;\r\n        sreg |= 1 & ((~val1 & val2) | (val2 & R) | (R & ~val1)) ? 0x20 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xfc00) === 0x400) {\r\n        /* CPC, 0000 01rd dddd rrrr */\r\n        const arg1 = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const arg2 = cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)];\r\n        let sreg = cpu.data[95];\r\n        const r = arg1 - arg2 - (sreg & 1);\r\n        sreg = (sreg & 0xc0) | (!r && (sreg >> 1) & 1 ? 2 : 0) | (arg2 + (sreg & 1) > arg1 ? 1 : 0);\r\n        sreg |= 128 & r ? 4 : 0;\r\n        sreg |= (arg1 ^ arg2) & (arg1 ^ r) & 128 ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= 1 & ((~arg1 & arg2) | (arg2 & r) | (r & ~arg1)) ? 0x20 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xf000) === 0x3000) {\r\n        /* CPI, 0011 KKKK dddd KKKK */\r\n        const arg1 = cpu.data[((opcode & 0xf0) >> 4) + 16];\r\n        const arg2 = (opcode & 0xf) | ((opcode & 0xf00) >> 4);\r\n        const r = arg1 - arg2;\r\n        let sreg = cpu.data[95] & 0xc0;\r\n        sreg |= r ? 0 : 2;\r\n        sreg |= 128 & r ? 4 : 0;\r\n        sreg |= (arg1 ^ arg2) & (arg1 ^ r) & 128 ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= arg2 > arg1 ? 1 : 0;\r\n        sreg |= 1 & ((~arg1 & arg2) | (arg2 & r) | (r & ~arg1)) ? 0x20 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xfc00) === 0x1000) {\r\n        /* CPSE, 0001 00rd dddd rrrr */\r\n        if (cpu.data[(opcode & 0x1f0) >> 4] === cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)]) {\r\n            const nextOpcode = cpu.progMem[cpu.pc + 1];\r\n            const skipSize = isTwoWordInstruction(nextOpcode) ? 2 : 1;\r\n            cpu.pc += skipSize;\r\n            cpu.cycles += skipSize;\r\n        }\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x940a) {\r\n        /* DEC, 1001 010d dddd 1010 */\r\n        const value = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const R = value - 1;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = R;\r\n        let sreg = cpu.data[95] & 0xe1;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= 128 === value ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if (opcode === 0x9519) {\r\n        /* EICALL, 1001 0101 0001 1001 */\r\n        const retAddr = cpu.pc + 1;\r\n        const sp = cpu.dataView.getUint16(93, true);\r\n        const eind = cpu.data[0x5c];\r\n        cpu.data[sp] = retAddr & 255;\r\n        cpu.data[sp - 1] = (retAddr >> 8) & 255;\r\n        cpu.data[sp - 2] = (retAddr >> 16) & 255;\r\n        cpu.dataView.setUint16(93, sp - 3, true);\r\n        cpu.pc = ((eind << 16) | cpu.dataView.getUint16(30, true)) - 1;\r\n        cpu.cycles += 3;\r\n    }\r\n    else if (opcode === 0x9419) {\r\n        /* EIJMP, 1001 0100 0001 1001 */\r\n        const eind = cpu.data[0x5c];\r\n        cpu.pc = ((eind << 16) | cpu.dataView.getUint16(30, true)) - 1;\r\n        cpu.cycles++;\r\n    }\r\n    else if (opcode === 0x95d8) {\r\n        /* ELPM, 1001 0101 1101 1000 */\r\n        const rampz = cpu.data[0x5b];\r\n        cpu.data[0] = cpu.progBytes[(rampz << 16) | cpu.dataView.getUint16(30, true)];\r\n        cpu.cycles += 2;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9006) {\r\n        /* ELPM(REG), 1001 000d dddd 0110 */\r\n        const rampz = cpu.data[0x5b];\r\n        cpu.data[(opcode & 0x1f0) >> 4] =\r\n            cpu.progBytes[(rampz << 16) | cpu.dataView.getUint16(30, true)];\r\n        cpu.cycles += 2;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9007) {\r\n        /* ELPM(INC), 1001 000d dddd 0111 */\r\n        const rampz = cpu.data[0x5b];\r\n        const i = cpu.dataView.getUint16(30, true);\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.progBytes[(rampz << 16) | i];\r\n        cpu.dataView.setUint16(30, i + 1, true);\r\n        if (i === 0xffff) {\r\n            cpu.data[0x5b] = (rampz + 1) % (cpu.progBytes.length >> 16);\r\n        }\r\n        cpu.cycles += 2;\r\n    }\r\n    else if ((opcode & 0xfc00) === 0x2400) {\r\n        /* EOR, 0010 01rd dddd rrrr */\r\n        const R = cpu.data[(opcode & 0x1f0) >> 4] ^ cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)];\r\n        cpu.data[(opcode & 0x1f0) >> 4] = R;\r\n        let sreg = cpu.data[95] & 0xe1;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xff88) === 0x308) {\r\n        /* FMUL, 0000 0011 0ddd 1rrr */\r\n        const v1 = cpu.data[((opcode & 0x70) >> 4) + 16];\r\n        const v2 = cpu.data[(opcode & 7) + 16];\r\n        const R = (v1 * v2) << 1;\r\n        cpu.dataView.setUint16(0, R, true);\r\n        cpu.data[95] = (cpu.data[95] & 0xfc) | (0xffff & R ? 0 : 2) | ((v1 * v2) & 0x8000 ? 1 : 0);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xff88) === 0x380) {\r\n        /* FMULS, 0000 0011 1ddd 0rrr */\r\n        const v1 = cpu.dataView.getInt8(((opcode & 0x70) >> 4) + 16);\r\n        const v2 = cpu.dataView.getInt8((opcode & 7) + 16);\r\n        const R = (v1 * v2) << 1;\r\n        cpu.dataView.setInt16(0, R, true);\r\n        cpu.data[95] = (cpu.data[95] & 0xfc) | (0xffff & R ? 0 : 2) | ((v1 * v2) & 0x8000 ? 1 : 0);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xff88) === 0x388) {\r\n        /* FMULSU, 0000 0011 1ddd 1rrr */\r\n        const v1 = cpu.dataView.getInt8(((opcode & 0x70) >> 4) + 16);\r\n        const v2 = cpu.data[(opcode & 7) + 16];\r\n        const R = (v1 * v2) << 1;\r\n        cpu.dataView.setInt16(0, R, true);\r\n        cpu.data[95] = (cpu.data[95] & 0xfc) | (0xffff & R ? 2 : 0) | ((v1 * v2) & 0x8000 ? 1 : 0);\r\n        cpu.cycles++;\r\n    }\r\n    else if (opcode === 0x9509) {\r\n        /* ICALL, 1001 0101 0000 1001 */\r\n        const retAddr = cpu.pc + 1;\r\n        const sp = cpu.dataView.getUint16(93, true);\r\n        const { pc22Bits } = cpu;\r\n        cpu.data[sp] = retAddr & 255;\r\n        cpu.data[sp - 1] = (retAddr >> 8) & 255;\r\n        if (pc22Bits) {\r\n            cpu.data[sp - 2] = (retAddr >> 16) & 255;\r\n        }\r\n        cpu.dataView.setUint16(93, sp - (pc22Bits ? 3 : 2), true);\r\n        cpu.pc = cpu.dataView.getUint16(30, true) - 1;\r\n        cpu.cycles += pc22Bits ? 3 : 2;\r\n    }\r\n    else if (opcode === 0x9409) {\r\n        /* IJMP, 1001 0100 0000 1001 */\r\n        cpu.pc = cpu.dataView.getUint16(30, true) - 1;\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xf800) === 0xb000) {\r\n        /* IN, 1011 0AAd dddd AAAA */\r\n        const i = cpu.readData(((opcode & 0xf) | ((opcode & 0x600) >> 5)) + 32);\r\n        cpu.data[(opcode & 0x1f0) >> 4] = i;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9403) {\r\n        /* INC, 1001 010d dddd 0011 */\r\n        const d = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const r = (d + 1) & 255;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = r;\r\n        let sreg = cpu.data[95] & 0xe1;\r\n        sreg |= r ? 0 : 2;\r\n        sreg |= 128 & r ? 4 : 0;\r\n        sreg |= 127 === d ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xfe0e) === 0x940c) {\r\n        /* JMP, 1001 010k kkkk 110k kkkk kkkk kkkk kkkk */\r\n        cpu.pc = (cpu.progMem[cpu.pc + 1] | ((opcode & 1) << 16) | ((opcode & 0x1f0) << 13)) - 1;\r\n        cpu.cycles += 2;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9206) {\r\n        /* LAC, 1001 001r rrrr 0110 */\r\n        const r = (opcode & 0x1f0) >> 4;\r\n        const clear = cpu.data[r];\r\n        const value = cpu.readData(cpu.dataView.getUint16(30, true));\r\n        cpu.writeData(cpu.dataView.getUint16(30, true), value & (255 - clear));\r\n        cpu.data[r] = value;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9205) {\r\n        /* LAS, 1001 001r rrrr 0101 */\r\n        const r = (opcode & 0x1f0) >> 4;\r\n        const set = cpu.data[r];\r\n        const value = cpu.readData(cpu.dataView.getUint16(30, true));\r\n        cpu.writeData(cpu.dataView.getUint16(30, true), value | set);\r\n        cpu.data[r] = value;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9207) {\r\n        /* LAT, 1001 001r rrrr 0111 */\r\n        const r = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const R = cpu.readData(cpu.dataView.getUint16(30, true));\r\n        cpu.writeData(cpu.dataView.getUint16(30, true), r ^ R);\r\n        cpu.data[(opcode & 0x1f0) >> 4] = R;\r\n    }\r\n    else if ((opcode & 0xf000) === 0xe000) {\r\n        /* LDI, 1110 KKKK dddd KKKK */\r\n        cpu.data[((opcode & 0xf0) >> 4) + 16] = (opcode & 0xf) | ((opcode & 0xf00) >> 4);\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9000) {\r\n        /* LDS, 1001 000d dddd 0000 kkkk kkkk kkkk kkkk */\r\n        cpu.cycles++;\r\n        const value = cpu.readData(cpu.progMem[cpu.pc + 1]);\r\n        cpu.data[(opcode & 0x1f0) >> 4] = value;\r\n        cpu.pc++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x900c) {\r\n        /* LDX, 1001 000d dddd 1100 */\r\n        cpu.cycles++;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.readData(cpu.dataView.getUint16(26, true));\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x900d) {\r\n        /* LDX(INC), 1001 000d dddd 1101 */\r\n        const x = cpu.dataView.getUint16(26, true);\r\n        cpu.cycles++;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.readData(x);\r\n        cpu.dataView.setUint16(26, x + 1, true);\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x900e) {\r\n        /* LDX(DEC), 1001 000d dddd 1110 */\r\n        const x = cpu.dataView.getUint16(26, true) - 1;\r\n        cpu.dataView.setUint16(26, x, true);\r\n        cpu.cycles++;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.readData(x);\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x8008) {\r\n        /* LDY, 1000 000d dddd 1000 */\r\n        cpu.cycles++;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.readData(cpu.dataView.getUint16(28, true));\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9009) {\r\n        /* LDY(INC), 1001 000d dddd 1001 */\r\n        const y = cpu.dataView.getUint16(28, true);\r\n        cpu.cycles++;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.readData(y);\r\n        cpu.dataView.setUint16(28, y + 1, true);\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x900a) {\r\n        /* LDY(DEC), 1001 000d dddd 1010 */\r\n        const y = cpu.dataView.getUint16(28, true) - 1;\r\n        cpu.dataView.setUint16(28, y, true);\r\n        cpu.cycles++;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.readData(y);\r\n    }\r\n    else if ((opcode & 0xd208) === 0x8008 &&\r\n        (opcode & 7) | ((opcode & 0xc00) >> 7) | ((opcode & 0x2000) >> 8)) {\r\n        /* LDDY, 10q0 qq0d dddd 1qqq */\r\n        cpu.cycles++;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.readData(cpu.dataView.getUint16(28, true) +\r\n            ((opcode & 7) | ((opcode & 0xc00) >> 7) | ((opcode & 0x2000) >> 8)));\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x8000) {\r\n        /* LDZ, 1000 000d dddd 0000 */\r\n        cpu.cycles++;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.readData(cpu.dataView.getUint16(30, true));\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9001) {\r\n        /* LDZ(INC), 1001 000d dddd 0001 */\r\n        const z = cpu.dataView.getUint16(30, true);\r\n        cpu.cycles++;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.readData(z);\r\n        cpu.dataView.setUint16(30, z + 1, true);\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9002) {\r\n        /* LDZ(DEC), 1001 000d dddd 0010 */\r\n        const z = cpu.dataView.getUint16(30, true) - 1;\r\n        cpu.dataView.setUint16(30, z, true);\r\n        cpu.cycles++;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.readData(z);\r\n    }\r\n    else if ((opcode & 0xd208) === 0x8000 &&\r\n        (opcode & 7) | ((opcode & 0xc00) >> 7) | ((opcode & 0x2000) >> 8)) {\r\n        /* LDDZ, 10q0 qq0d dddd 0qqq */\r\n        cpu.cycles++;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.readData(cpu.dataView.getUint16(30, true) +\r\n            ((opcode & 7) | ((opcode & 0xc00) >> 7) | ((opcode & 0x2000) >> 8)));\r\n    }\r\n    else if (opcode === 0x95c8) {\r\n        /* LPM, 1001 0101 1100 1000 */\r\n        cpu.data[0] = cpu.progBytes[cpu.dataView.getUint16(30, true)];\r\n        cpu.cycles += 2;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9004) {\r\n        /* LPM(REG), 1001 000d dddd 0100 */\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.progBytes[cpu.dataView.getUint16(30, true)];\r\n        cpu.cycles += 2;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9005) {\r\n        /* LPM(INC), 1001 000d dddd 0101 */\r\n        const i = cpu.dataView.getUint16(30, true);\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.progBytes[i];\r\n        cpu.dataView.setUint16(30, i + 1, true);\r\n        cpu.cycles += 2;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9406) {\r\n        /* LSR, 1001 010d dddd 0110 */\r\n        const value = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const R = value >>> 1;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = R;\r\n        let sreg = cpu.data[95] & 0xe0;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= value & 1;\r\n        sreg |= ((sreg >> 2) & 1) ^ (sreg & 1) ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xfc00) === 0x2c00) {\r\n        /* MOV, 0010 11rd dddd rrrr */\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)];\r\n    }\r\n    else if ((opcode & 0xff00) === 0x100) {\r\n        /* MOVW, 0000 0001 dddd rrrr */\r\n        const r2 = 2 * (opcode & 0xf);\r\n        const d2 = 2 * ((opcode & 0xf0) >> 4);\r\n        cpu.data[d2] = cpu.data[r2];\r\n        cpu.data[d2 + 1] = cpu.data[r2 + 1];\r\n    }\r\n    else if ((opcode & 0xfc00) === 0x9c00) {\r\n        /* MUL, 1001 11rd dddd rrrr */\r\n        const R = cpu.data[(opcode & 0x1f0) >> 4] * cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)];\r\n        cpu.dataView.setUint16(0, R, true);\r\n        cpu.data[95] = (cpu.data[95] & 0xfc) | (0xffff & R ? 0 : 2) | (0x8000 & R ? 1 : 0);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xff00) === 0x200) {\r\n        /* MULS, 0000 0010 dddd rrrr */\r\n        const R = cpu.dataView.getInt8(((opcode & 0xf0) >> 4) + 16) * cpu.dataView.getInt8((opcode & 0xf) + 16);\r\n        cpu.dataView.setInt16(0, R, true);\r\n        cpu.data[95] = (cpu.data[95] & 0xfc) | (0xffff & R ? 0 : 2) | (0x8000 & R ? 1 : 0);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xff88) === 0x300) {\r\n        /* MULSU, 0000 0011 0ddd 0rrr */\r\n        const R = cpu.dataView.getInt8(((opcode & 0x70) >> 4) + 16) * cpu.data[(opcode & 7) + 16];\r\n        cpu.dataView.setInt16(0, R, true);\r\n        cpu.data[95] = (cpu.data[95] & 0xfc) | (0xffff & R ? 0 : 2) | (0x8000 & R ? 1 : 0);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9401) {\r\n        /* NEG, 1001 010d dddd 0001 */\r\n        const d = (opcode & 0x1f0) >> 4;\r\n        const value = cpu.data[d];\r\n        const R = 0 - value;\r\n        cpu.data[d] = R;\r\n        let sreg = cpu.data[95] & 0xc0;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= 128 === R ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= R ? 1 : 0;\r\n        sreg |= 1 & (R | value) ? 0x20 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if (opcode === 0) {\r\n        /* NOP, 0000 0000 0000 0000 */\r\n        /* NOP */\r\n    }\r\n    else if ((opcode & 0xfc00) === 0x2800) {\r\n        /* OR, 0010 10rd dddd rrrr */\r\n        const R = cpu.data[(opcode & 0x1f0) >> 4] | cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)];\r\n        cpu.data[(opcode & 0x1f0) >> 4] = R;\r\n        let sreg = cpu.data[95] & 0xe1;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xf000) === 0x6000) {\r\n        /* SBR, 0110 KKKK dddd KKKK */\r\n        const R = cpu.data[((opcode & 0xf0) >> 4) + 16] | ((opcode & 0xf) | ((opcode & 0xf00) >> 4));\r\n        cpu.data[((opcode & 0xf0) >> 4) + 16] = R;\r\n        let sreg = cpu.data[95] & 0xe1;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xf800) === 0xb800) {\r\n        /* OUT, 1011 1AAr rrrr AAAA */\r\n        cpu.writeData(((opcode & 0xf) | ((opcode & 0x600) >> 5)) + 32, cpu.data[(opcode & 0x1f0) >> 4]);\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x900f) {\r\n        /* POP, 1001 000d dddd 1111 */\r\n        const value = cpu.dataView.getUint16(93, true) + 1;\r\n        cpu.dataView.setUint16(93, value, true);\r\n        cpu.data[(opcode & 0x1f0) >> 4] = cpu.data[value];\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x920f) {\r\n        /* PUSH, 1001 001d dddd 1111 */\r\n        const value = cpu.dataView.getUint16(93, true);\r\n        cpu.data[value] = cpu.data[(opcode & 0x1f0) >> 4];\r\n        cpu.dataView.setUint16(93, value - 1, true);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xf000) === 0xd000) {\r\n        /* RCALL, 1101 kkkk kkkk kkkk */\r\n        const k = (opcode & 0x7ff) - (opcode & 0x800 ? 0x800 : 0);\r\n        const retAddr = cpu.pc + 1;\r\n        const sp = cpu.dataView.getUint16(93, true);\r\n        const { pc22Bits } = cpu;\r\n        cpu.data[sp] = 255 & retAddr;\r\n        cpu.data[sp - 1] = (retAddr >> 8) & 255;\r\n        if (pc22Bits) {\r\n            cpu.data[sp - 2] = (retAddr >> 16) & 255;\r\n        }\r\n        cpu.dataView.setUint16(93, sp - (pc22Bits ? 3 : 2), true);\r\n        cpu.pc += k;\r\n        cpu.cycles += pc22Bits ? 3 : 2;\r\n    }\r\n    else if (opcode === 0x9508) {\r\n        /* RET, 1001 0101 0000 1000 */\r\n        const { pc22Bits } = cpu;\r\n        const i = cpu.dataView.getUint16(93, true) + (pc22Bits ? 3 : 2);\r\n        cpu.dataView.setUint16(93, i, true);\r\n        cpu.pc = (cpu.data[i - 1] << 8) + cpu.data[i] - 1;\r\n        if (pc22Bits) {\r\n            cpu.pc |= cpu.data[i - 2] << 16;\r\n        }\r\n        cpu.cycles += pc22Bits ? 4 : 3;\r\n    }\r\n    else if (opcode === 0x9518) {\r\n        /* RETI, 1001 0101 0001 1000 */\r\n        const { pc22Bits } = cpu;\r\n        const i = cpu.dataView.getUint16(93, true) + (pc22Bits ? 3 : 2);\r\n        cpu.dataView.setUint16(93, i, true);\r\n        cpu.pc = (cpu.data[i - 1] << 8) + cpu.data[i] - 1;\r\n        if (pc22Bits) {\r\n            cpu.pc |= cpu.data[i - 2] << 16;\r\n        }\r\n        cpu.cycles += pc22Bits ? 4 : 3;\r\n        cpu.data[95] |= 0x80; // Enable interrupts\r\n    }\r\n    else if ((opcode & 0xf000) === 0xc000) {\r\n        /* RJMP, 1100 kkkk kkkk kkkk */\r\n        cpu.pc = cpu.pc + ((opcode & 0x7ff) - (opcode & 0x800 ? 0x800 : 0));\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9407) {\r\n        /* ROR, 1001 010d dddd 0111 */\r\n        const d = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const r = (d >>> 1) | ((cpu.data[95] & 1) << 7);\r\n        cpu.data[(opcode & 0x1f0) >> 4] = r;\r\n        let sreg = cpu.data[95] & 0xe0;\r\n        sreg |= r ? 0 : 2;\r\n        sreg |= 128 & r ? 4 : 0;\r\n        sreg |= 1 & d ? 1 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ (sreg & 1) ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xfc00) === 0x800) {\r\n        /* SBC, 0000 10rd dddd rrrr */\r\n        const val1 = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const val2 = cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)];\r\n        let sreg = cpu.data[95];\r\n        const R = val1 - val2 - (sreg & 1);\r\n        cpu.data[(opcode & 0x1f0) >> 4] = R;\r\n        sreg = (sreg & 0xc0) | (!R && (sreg >> 1) & 1 ? 2 : 0) | (val2 + (sreg & 1) > val1 ? 1 : 0);\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= (val1 ^ val2) & (val1 ^ R) & 128 ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= 1 & ((~val1 & val2) | (val2 & R) | (R & ~val1)) ? 0x20 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xf000) === 0x4000) {\r\n        /* SBCI, 0100 KKKK dddd KKKK */\r\n        const val1 = cpu.data[((opcode & 0xf0) >> 4) + 16];\r\n        const val2 = (opcode & 0xf) | ((opcode & 0xf00) >> 4);\r\n        let sreg = cpu.data[95];\r\n        const R = val1 - val2 - (sreg & 1);\r\n        cpu.data[((opcode & 0xf0) >> 4) + 16] = R;\r\n        sreg = (sreg & 0xc0) | (!R && (sreg >> 1) & 1 ? 2 : 0) | (val2 + (sreg & 1) > val1 ? 1 : 0);\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= (val1 ^ val2) & (val1 ^ R) & 128 ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= 1 & ((~val1 & val2) | (val2 & R) | (R & ~val1)) ? 0x20 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xff00) === 0x9a00) {\r\n        /* SBI, 1001 1010 AAAA Abbb */\r\n        const target = ((opcode & 0xf8) >> 3) + 32;\r\n        const mask = 1 << (opcode & 7);\r\n        cpu.writeData(target, cpu.readData(target) | mask, mask);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xff00) === 0x9900) {\r\n        /* SBIC, 1001 1001 AAAA Abbb */\r\n        const value = cpu.readData(((opcode & 0xf8) >> 3) + 32);\r\n        if (!(value & (1 << (opcode & 7)))) {\r\n            const nextOpcode = cpu.progMem[cpu.pc + 1];\r\n            const skipSize = isTwoWordInstruction(nextOpcode) ? 2 : 1;\r\n            cpu.cycles += skipSize;\r\n            cpu.pc += skipSize;\r\n        }\r\n    }\r\n    else if ((opcode & 0xff00) === 0x9b00) {\r\n        /* SBIS, 1001 1011 AAAA Abbb */\r\n        const value = cpu.readData(((opcode & 0xf8) >> 3) + 32);\r\n        if (value & (1 << (opcode & 7))) {\r\n            const nextOpcode = cpu.progMem[cpu.pc + 1];\r\n            const skipSize = isTwoWordInstruction(nextOpcode) ? 2 : 1;\r\n            cpu.cycles += skipSize;\r\n            cpu.pc += skipSize;\r\n        }\r\n    }\r\n    else if ((opcode & 0xff00) === 0x9700) {\r\n        /* SBIW, 1001 0111 KKdd KKKK */\r\n        const i = 2 * ((opcode & 0x30) >> 4) + 24;\r\n        const a = cpu.dataView.getUint16(i, true);\r\n        const l = (opcode & 0xf) | ((opcode & 0xc0) >> 2);\r\n        const R = a - l;\r\n        cpu.dataView.setUint16(i, R, true);\r\n        let sreg = cpu.data[95] & 0xc0;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 0x8000 & R ? 4 : 0;\r\n        sreg |= a & ~R & 0x8000 ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= l > a ? 1 : 0;\r\n        sreg |= 1 & ((~a & l) | (l & R) | (R & ~a)) ? 0x20 : 0;\r\n        cpu.data[95] = sreg;\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe08) === 0xfc00) {\r\n        /* SBRC, 1111 110r rrrr 0bbb */\r\n        if (!(cpu.data[(opcode & 0x1f0) >> 4] & (1 << (opcode & 7)))) {\r\n            const nextOpcode = cpu.progMem[cpu.pc + 1];\r\n            const skipSize = isTwoWordInstruction(nextOpcode) ? 2 : 1;\r\n            cpu.cycles += skipSize;\r\n            cpu.pc += skipSize;\r\n        }\r\n    }\r\n    else if ((opcode & 0xfe08) === 0xfe00) {\r\n        /* SBRS, 1111 111r rrrr 0bbb */\r\n        if (cpu.data[(opcode & 0x1f0) >> 4] & (1 << (opcode & 7))) {\r\n            const nextOpcode = cpu.progMem[cpu.pc + 1];\r\n            const skipSize = isTwoWordInstruction(nextOpcode) ? 2 : 1;\r\n            cpu.cycles += skipSize;\r\n            cpu.pc += skipSize;\r\n        }\r\n    }\r\n    else if (opcode === 0x9588) {\r\n        /* SLEEP, 1001 0101 1000 1000 */\r\n        /* not implemented */\r\n    }\r\n    else if (opcode === 0x95e8) {\r\n        /* SPM, 1001 0101 1110 1000 */\r\n        /* not implemented */\r\n    }\r\n    else if (opcode === 0x95f8) {\r\n        /* SPM(INC), 1001 0101 1111 1000 */\r\n        /* not implemented */\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9200) {\r\n        /* STS, 1001 001d dddd 0000 kkkk kkkk kkkk kkkk */\r\n        const value = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const addr = cpu.progMem[cpu.pc + 1];\r\n        cpu.writeData(addr, value);\r\n        cpu.pc++;\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x920c) {\r\n        /* STX, 1001 001r rrrr 1100 */\r\n        cpu.writeData(cpu.dataView.getUint16(26, true), cpu.data[(opcode & 0x1f0) >> 4]);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x920d) {\r\n        /* STX(INC), 1001 001r rrrr 1101 */\r\n        const x = cpu.dataView.getUint16(26, true);\r\n        cpu.writeData(x, cpu.data[(opcode & 0x1f0) >> 4]);\r\n        cpu.dataView.setUint16(26, x + 1, true);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x920e) {\r\n        /* STX(DEC), 1001 001r rrrr 1110 */\r\n        const i = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const x = cpu.dataView.getUint16(26, true) - 1;\r\n        cpu.dataView.setUint16(26, x, true);\r\n        cpu.writeData(x, i);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x8208) {\r\n        /* STY, 1000 001r rrrr 1000 */\r\n        cpu.writeData(cpu.dataView.getUint16(28, true), cpu.data[(opcode & 0x1f0) >> 4]);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9209) {\r\n        /* STY(INC), 1001 001r rrrr 1001 */\r\n        const i = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const y = cpu.dataView.getUint16(28, true);\r\n        cpu.writeData(y, i);\r\n        cpu.dataView.setUint16(28, y + 1, true);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x920a) {\r\n        /* STY(DEC), 1001 001r rrrr 1010 */\r\n        const i = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const y = cpu.dataView.getUint16(28, true) - 1;\r\n        cpu.dataView.setUint16(28, y, true);\r\n        cpu.writeData(y, i);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xd208) === 0x8208 &&\r\n        (opcode & 7) | ((opcode & 0xc00) >> 7) | ((opcode & 0x2000) >> 8)) {\r\n        /* STDY, 10q0 qq1r rrrr 1qqq */\r\n        cpu.writeData(cpu.dataView.getUint16(28, true) +\r\n            ((opcode & 7) | ((opcode & 0xc00) >> 7) | ((opcode & 0x2000) >> 8)), cpu.data[(opcode & 0x1f0) >> 4]);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x8200) {\r\n        /* STZ, 1000 001r rrrr 0000 */\r\n        cpu.writeData(cpu.dataView.getUint16(30, true), cpu.data[(opcode & 0x1f0) >> 4]);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9201) {\r\n        /* STZ(INC), 1001 001r rrrr 0001 */\r\n        const z = cpu.dataView.getUint16(30, true);\r\n        cpu.writeData(z, cpu.data[(opcode & 0x1f0) >> 4]);\r\n        cpu.dataView.setUint16(30, z + 1, true);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9202) {\r\n        /* STZ(DEC), 1001 001r rrrr 0010 */\r\n        const i = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const z = cpu.dataView.getUint16(30, true) - 1;\r\n        cpu.dataView.setUint16(30, z, true);\r\n        cpu.writeData(z, i);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xd208) === 0x8200 &&\r\n        (opcode & 7) | ((opcode & 0xc00) >> 7) | ((opcode & 0x2000) >> 8)) {\r\n        /* STDZ, 10q0 qq1r rrrr 0qqq */\r\n        cpu.writeData(cpu.dataView.getUint16(30, true) +\r\n            ((opcode & 7) | ((opcode & 0xc00) >> 7) | ((opcode & 0x2000) >> 8)), cpu.data[(opcode & 0x1f0) >> 4]);\r\n        cpu.cycles++;\r\n    }\r\n    else if ((opcode & 0xfc00) === 0x1800) {\r\n        /* SUB, 0001 10rd dddd rrrr */\r\n        const val1 = cpu.data[(opcode & 0x1f0) >> 4];\r\n        const val2 = cpu.data[(opcode & 0xf) | ((opcode & 0x200) >> 5)];\r\n        const R = val1 - val2;\r\n        cpu.data[(opcode & 0x1f0) >> 4] = R;\r\n        let sreg = cpu.data[95] & 0xc0;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= (val1 ^ val2) & (val1 ^ R) & 128 ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= val2 > val1 ? 1 : 0;\r\n        sreg |= 1 & ((~val1 & val2) | (val2 & R) | (R & ~val1)) ? 0x20 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xf000) === 0x5000) {\r\n        /* SUBI, 0101 KKKK dddd KKKK */\r\n        const val1 = cpu.data[((opcode & 0xf0) >> 4) + 16];\r\n        const val2 = (opcode & 0xf) | ((opcode & 0xf00) >> 4);\r\n        const R = val1 - val2;\r\n        cpu.data[((opcode & 0xf0) >> 4) + 16] = R;\r\n        let sreg = cpu.data[95] & 0xc0;\r\n        sreg |= R ? 0 : 2;\r\n        sreg |= 128 & R ? 4 : 0;\r\n        sreg |= (val1 ^ val2) & (val1 ^ R) & 128 ? 8 : 0;\r\n        sreg |= ((sreg >> 2) & 1) ^ ((sreg >> 3) & 1) ? 0x10 : 0;\r\n        sreg |= val2 > val1 ? 1 : 0;\r\n        sreg |= 1 & ((~val1 & val2) | (val2 & R) | (R & ~val1)) ? 0x20 : 0;\r\n        cpu.data[95] = sreg;\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9402) {\r\n        /* SWAP, 1001 010d dddd 0010 */\r\n        const d = (opcode & 0x1f0) >> 4;\r\n        const i = cpu.data[d];\r\n        cpu.data[d] = ((15 & i) << 4) | ((240 & i) >>> 4);\r\n    }\r\n    else if (opcode === 0x95a8) {\r\n        /* WDR, 1001 0101 1010 1000 */\r\n        cpu.onWatchdogReset();\r\n    }\r\n    else if ((opcode & 0xfe0f) === 0x9204) {\r\n        /* XCH, 1001 001r rrrr 0100 */\r\n        const r = (opcode & 0x1f0) >> 4;\r\n        const val1 = cpu.data[r];\r\n        const val2 = cpu.data[cpu.dataView.getUint16(30, true)];\r\n        cpu.data[cpu.dataView.getUint16(30, true)] = val1;\r\n        cpu.data[r] = val2;\r\n    }\r\n    cpu.pc = (cpu.pc + 1) % cpu.progMem.length;\r\n    cpu.cycles++;\r\n}\r\n", "/**\r\n * AVR-8 ADC\r\n * Part of AVR8js\r\n * Reference: http://ww1.microchip.com/downloads/en/DeviceDoc/ATmega48A-PA-88A-PA-168A-PA-328-P-DS-DS40002061A.pdf\r\n *\r\n * Copyright (C) 2019, 2020, 2021 Uri Shaked\r\n */\r\nexport var ADCReference;\r\n(function (ADCReference) {\r\n    ADCReference[ADCReference[\"AVCC\"] = 0] = \"AVCC\";\r\n    ADCReference[ADCReference[\"AREF\"] = 1] = \"AREF\";\r\n    ADCReference[ADCReference[\"Internal1V1\"] = 2] = \"Internal1V1\";\r\n    ADCReference[ADCReference[\"Internal2V56\"] = 3] = \"Internal2V56\";\r\n    ADCReference[ADCReference[\"Reserved\"] = 4] = \"Reserved\";\r\n})(ADCReference || (ADCReference = {}));\r\nexport var ADCMuxInputType;\r\n(function (ADCMuxInputType) {\r\n    ADCMuxInputType[ADCMuxInputType[\"SingleEnded\"] = 0] = \"SingleEnded\";\r\n    ADCMuxInputType[ADCMuxInputType[\"Differential\"] = 1] = \"Differential\";\r\n    ADCMuxInputType[ADCMuxInputType[\"Constant\"] = 2] = \"Constant\";\r\n    ADCMuxInputType[ADCMuxInputType[\"Temperature\"] = 3] = \"Temperature\";\r\n})(ADCMuxInputType || (ADCMuxInputType = {}));\r\nexport const atmega328Channels = {\r\n    0: { type: ADCMuxInputType.SingleEnded, channel: 0 },\r\n    1: { type: ADCMuxInputType.SingleEnded, channel: 1 },\r\n    2: { type: ADCMuxInputType.SingleEnded, channel: 2 },\r\n    3: { type: ADCMuxInputType.SingleEnded, channel: 3 },\r\n    4: { type: ADCMuxInputType.SingleEnded, channel: 4 },\r\n    5: { type: ADCMuxInputType.SingleEnded, channel: 5 },\r\n    6: { type: ADCMuxInputType.SingleEnded, channel: 6 },\r\n    7: { type: ADCMuxInputType.SingleEnded, channel: 7 },\r\n    8: { type: ADCMuxInputType.Temperature },\r\n    14: { type: ADCMuxInputType.Constant, voltage: 1.1 },\r\n    15: { type: ADCMuxInputType.Constant, voltage: 0 },\r\n};\r\nconst fallbackMuxInput = {\r\n    type: ADCMuxInputType.Constant,\r\n    voltage: 0,\r\n};\r\nexport const adcConfig = {\r\n    ADMUX: 0x7c,\r\n    ADCSRA: 0x7a,\r\n    ADCSRB: 0x7b,\r\n    ADCL: 0x78,\r\n    ADCH: 0x79,\r\n    DIDR0: 0x7e,\r\n    adcInterrupt: 0x2a,\r\n    numChannels: 8,\r\n    muxInputMask: 0xf,\r\n    muxChannels: atmega328Channels,\r\n    adcReferences: [\r\n        ADCReference.AREF,\r\n        ADCReference.AVCC,\r\n        ADCReference.Reserved,\r\n        ADCReference.Internal1V1,\r\n    ],\r\n};\r\n// Register bits:\r\nconst ADPS_MASK = 0x7;\r\nconst ADIE = 0x8;\r\nconst ADIF = 0x10;\r\nconst ADSC = 0x40;\r\nconst ADEN = 0x80;\r\nconst MUX_MASK = 0x1f;\r\nconst ADLAR = 0x20;\r\nconst MUX5 = 0x8;\r\nconst REFS2 = 0x8;\r\nconst REFS_MASK = 0x3;\r\nconst REFS_SHIFT = 6;\r\nexport class AVRADC {\r\n    constructor(cpu, config) {\r\n        this.cpu = cpu;\r\n        this.config = config;\r\n        /**\r\n         * ADC Channel values, in voltage (0..5). The number of channels depends on the chip.\r\n         *\r\n         * Changing the values here will change the ADC reading, unless you override onADCRead() with a custom implementation.\r\n         */\r\n        this.channelValues = new Array(this.config.numChannels);\r\n        /** AVCC Reference voltage */\r\n        this.avcc = 5;\r\n        /** AREF Reference voltage */\r\n        this.aref = 5;\r\n        /**\r\n         * Invoked whenever the code performs an ADC read.\r\n         *\r\n         * The default implementation reads the result from the `channelValues` array, and then calls\r\n         * `completeADCRead()` after `sampleCycles` CPU cycles.\r\n         *\r\n         * If you override the default implementation, make sure to call `completeADCRead()` after\r\n         * `sampleCycles` cycles (or else the ADC read will never complete).\r\n         */\r\n        this.onADCRead = (input) => {\r\n            var _a;\r\n            // Default implementation\r\n            let voltage = 0;\r\n            switch (input.type) {\r\n                case ADCMuxInputType.Constant:\r\n                    voltage = input.voltage;\r\n                    break;\r\n                case ADCMuxInputType.SingleEnded:\r\n                    voltage = (_a = this.channelValues[input.channel]) !== null && _a !== void 0 ? _a : 0;\r\n                    break;\r\n                case ADCMuxInputType.Differential:\r\n                    voltage =\r\n                        input.gain *\r\n                            ((this.channelValues[input.positiveChannel] || 0) -\r\n                                (this.channelValues[input.negativeChannel] || 0));\r\n                    break;\r\n                case ADCMuxInputType.Temperature:\r\n                    voltage = 0.378125; // 25 celcius\r\n                    break;\r\n            }\r\n            const rawValue = (voltage / this.referenceVoltage) * 1024;\r\n            const result = Math.min(Math.max(Math.floor(rawValue), 0), 1023);\r\n            this.cpu.addClockEvent(() => this.completeADCRead(result), this.sampleCycles);\r\n        };\r\n        this.converting = false;\r\n        this.conversionCycles = 25;\r\n        // Interrupts\r\n        this.ADC = {\r\n            address: this.config.adcInterrupt,\r\n            flagRegister: this.config.ADCSRA,\r\n            flagMask: ADIF,\r\n            enableRegister: this.config.ADCSRA,\r\n            enableMask: ADIE,\r\n        };\r\n        cpu.writeHooks[config.ADCSRA] = (value, oldValue) => {\r\n            var _a;\r\n            if (value & ADEN && !(oldValue && ADEN)) {\r\n                this.conversionCycles = 25;\r\n            }\r\n            cpu.data[config.ADCSRA] = value;\r\n            cpu.updateInterruptEnable(this.ADC, value);\r\n            if (!this.converting && value & ADSC) {\r\n                if (!(value & ADEN)) {\r\n                    // Special case: reading while the ADC is not enabled should return 0\r\n                    this.cpu.addClockEvent(() => this.completeADCRead(0), this.sampleCycles);\r\n                    return true;\r\n                }\r\n                let channel = this.cpu.data[this.config.ADMUX] & MUX_MASK;\r\n                if (cpu.data[config.ADCSRB] & MUX5) {\r\n                    channel |= 0x20;\r\n                }\r\n                channel &= config.muxInputMask;\r\n                const muxInput = (_a = config.muxChannels[channel]) !== null && _a !== void 0 ? _a : fallbackMuxInput;\r\n                this.converting = true;\r\n                this.onADCRead(muxInput);\r\n                return true; // don't update\r\n            }\r\n        };\r\n    }\r\n    completeADCRead(value) {\r\n        const { ADCL, ADCH, ADMUX, ADCSRA } = this.config;\r\n        this.converting = false;\r\n        this.conversionCycles = 13;\r\n        if (this.cpu.data[ADMUX] & ADLAR) {\r\n            this.cpu.data[ADCL] = (value << 6) & 0xff;\r\n            this.cpu.data[ADCH] = value >> 2;\r\n        }\r\n        else {\r\n            this.cpu.data[ADCL] = value & 0xff;\r\n            this.cpu.data[ADCH] = (value >> 8) & 0x3;\r\n        }\r\n        this.cpu.data[ADCSRA] &= ~ADSC;\r\n        this.cpu.setInterruptFlag(this.ADC);\r\n    }\r\n    get prescaler() {\r\n        const { ADCSRA } = this.config;\r\n        const adcsra = this.cpu.data[ADCSRA];\r\n        const adps = adcsra & ADPS_MASK;\r\n        switch (adps) {\r\n            case 0:\r\n            case 1:\r\n                return 2;\r\n            case 2:\r\n                return 4;\r\n            case 3:\r\n                return 8;\r\n            case 4:\r\n                return 16;\r\n            case 5:\r\n                return 32;\r\n            case 6:\r\n                return 64;\r\n            case 7:\r\n            default:\r\n                return 128;\r\n        }\r\n    }\r\n    get referenceVoltageType() {\r\n        var _a;\r\n        const { ADMUX, adcReferences } = this.config;\r\n        let refs = (this.cpu.data[ADMUX] >> REFS_SHIFT) & REFS_MASK;\r\n        if (adcReferences.length > 4 && this.cpu.data[ADMUX] & REFS2) {\r\n            refs |= 0x4;\r\n        }\r\n        return (_a = adcReferences[refs]) !== null && _a !== void 0 ? _a : ADCReference.Reserved;\r\n    }\r\n    get referenceVoltage() {\r\n        switch (this.referenceVoltageType) {\r\n            case ADCReference.AVCC:\r\n                return this.avcc;\r\n            case ADCReference.AREF:\r\n                return this.aref;\r\n            case ADCReference.Internal1V1:\r\n                return 1.1;\r\n            case ADCReference.Internal2V56:\r\n                return 2.56;\r\n            default:\r\n                return this.avcc;\r\n        }\r\n    }\r\n    get sampleCycles() {\r\n        return this.conversionCycles * this.prescaler;\r\n    }\r\n}\r\n", "/**\r\n * AVR8 Clock\r\n * Part of AVR8js\r\n * Reference: http://ww1.microchip.com/downloads/en/DeviceDoc/ATmega48A-PA-88A-PA-168A-PA-328-P-DS-DS40002061A.pdf\r\n *\r\n * Copyright (C) 2020, Uri Shaked\r\n */\r\nconst CLKPCE = 128;\r\nexport const clockConfig = {\r\n    CLKPR: 0x61,\r\n};\r\nconst prescalers = [\r\n    1, 2, 4, 8, 16, 32, 64, 128, 256,\r\n    // The following values are \"reserved\" according to the datasheet, so we measured\r\n    // with a scope to figure them out (on ATmega328p)\r\n    2, 4, 8, 16, 32, 64, 128,\r\n];\r\nexport class AVRClock {\r\n    constructor(cpu, baseFreqHz, config = clockConfig) {\r\n        this.cpu = cpu;\r\n        this.baseFreqHz = baseFreqHz;\r\n        this.config = config;\r\n        this.clockEnabledCycles = 0;\r\n        this.prescalerValue = 1;\r\n        this.cyclesDelta = 0;\r\n        this.cpu.writeHooks[this.config.CLKPR] = (clkpr) => {\r\n            if ((!this.clockEnabledCycles || this.clockEnabledCycles < cpu.cycles) && clkpr === CLKPCE) {\r\n                this.clockEnabledCycles = this.cpu.cycles + 4;\r\n            }\r\n            else if (this.clockEnabledCycles && this.clockEnabledCycles >= cpu.cycles) {\r\n                this.clockEnabledCycles = 0;\r\n                const index = clkpr & 0xf;\r\n                const oldPrescaler = this.prescalerValue;\r\n                this.prescalerValue = prescalers[index];\r\n                this.cpu.data[this.config.CLKPR] = index;\r\n                if (oldPrescaler !== this.prescalerValue) {\r\n                    this.cyclesDelta =\r\n                        (cpu.cycles + this.cyclesDelta) * (oldPrescaler / this.prescalerValue) - cpu.cycles;\r\n                }\r\n            }\r\n            return true;\r\n        };\r\n    }\r\n    get frequency() {\r\n        return this.baseFreqHz / this.prescalerValue;\r\n    }\r\n    get prescaler() {\r\n        return this.prescalerValue;\r\n    }\r\n    get timeNanos() {\r\n        return ((this.cpu.cycles + this.cyclesDelta) / this.frequency) * 1e9;\r\n    }\r\n    get timeMicros() {\r\n        return ((this.cpu.cycles + this.cyclesDelta) / this.frequency) * 1e6;\r\n    }\r\n    get timeMillis() {\r\n        return ((this.cpu.cycles + this.cyclesDelta) / this.frequency) * 1e3;\r\n    }\r\n}\r\n", "export class EEPROMMemoryBackend {\r\n    constructor(size) {\r\n        this.memory = new Uint8Array(size);\r\n        this.memory.fill(0xff);\r\n    }\r\n    readMemory(addr) {\r\n        return this.memory[addr];\r\n    }\r\n    writeMemory(addr, value) {\r\n        this.memory[addr] &= value;\r\n    }\r\n    eraseMemory(addr) {\r\n        this.memory[addr] = 0xff;\r\n    }\r\n}\r\nexport const eepromConfig = {\r\n    eepromReadyInterrupt: 0x2c,\r\n    EECR: 0x3f,\r\n    EEDR: 0x40,\r\n    EEARL: 0x41,\r\n    EEARH: 0x42,\r\n    eraseCycles: 28800,\r\n    writeCycles: 28800, // 1.8ms at 16MHz\r\n};\r\nconst EERE = 1 << 0;\r\nconst EEPE = 1 << 1;\r\nconst EEMPE = 1 << 2;\r\nconst EERIE = 1 << 3;\r\nconst EEPM0 = 1 << 4;\r\nconst EEPM1 = 1 << 5;\r\nconst EECR_WRITE_MASK = EEPE | EEMPE | EERIE | EEPM0 | EEPM1;\r\nexport class AVREEPROM {\r\n    constructor(cpu, backend, config = eepromConfig) {\r\n        this.cpu = cpu;\r\n        this.backend = backend;\r\n        this.config = config;\r\n        /**\r\n         * Used to keep track on the last write to EEMPE. From the datasheet:\r\n         * The EEMPE bit determines whether setting EEPE to one causes the EEPROM to be written.\r\n         * When EEMPE is set, setting EEPE within four clock cycles will write data to the EEPROM\r\n         * at the selected address If EEMPE is zero, setting EEPE will have no effect.\r\n         */\r\n        this.writeEnabledCycles = 0;\r\n        this.writeCompleteCycles = 0;\r\n        // Interrupts\r\n        this.EER = {\r\n            address: this.config.eepromReadyInterrupt,\r\n            flagRegister: this.config.EECR,\r\n            flagMask: EEPE,\r\n            enableRegister: this.config.EECR,\r\n            enableMask: EERIE,\r\n            constant: true,\r\n            inverseFlag: true,\r\n        };\r\n        this.cpu.writeHooks[this.config.EECR] = (eecr) => {\r\n            const { EEARH, EEARL, EECR, EEDR } = this.config;\r\n            const addr = (this.cpu.data[EEARH] << 8) | this.cpu.data[EEARL];\r\n            this.cpu.data[EECR] = (this.cpu.data[EECR] & ~EECR_WRITE_MASK) | (eecr & EECR_WRITE_MASK);\r\n            this.cpu.updateInterruptEnable(this.EER, eecr);\r\n            if (eecr & EERE) {\r\n                this.cpu.clearInterrupt(this.EER);\r\n            }\r\n            if (eecr & EEMPE) {\r\n                const eempeCycles = 4;\r\n                this.writeEnabledCycles = this.cpu.cycles + eempeCycles;\r\n                this.cpu.addClockEvent(() => {\r\n                    this.cpu.data[EECR] &= ~EEMPE;\r\n                }, eempeCycles);\r\n            }\r\n            // Read\r\n            if (eecr & EERE) {\r\n                this.cpu.data[EEDR] = this.backend.readMemory(addr);\r\n                // When the EEPROM is read, the CPU is halted for four cycles before the\r\n                // next instruction is executed.\r\n                this.cpu.cycles += 4;\r\n                return true;\r\n            }\r\n            // Write\r\n            if (eecr & EEPE) {\r\n                //  If EEMPE is zero, setting EEPE will have no effect.\r\n                if (this.cpu.cycles >= this.writeEnabledCycles) {\r\n                    this.cpu.data[EECR] &= ~EEPE;\r\n                    return true;\r\n                }\r\n                // Check for write-in-progress\r\n                if (this.cpu.cycles < this.writeCompleteCycles) {\r\n                    return true;\r\n                }\r\n                const eedr = this.cpu.data[EEDR];\r\n                this.writeCompleteCycles = this.cpu.cycles;\r\n                // Erase\r\n                if (!(eecr & EEPM1)) {\r\n                    this.backend.eraseMemory(addr);\r\n                    this.writeCompleteCycles += this.config.eraseCycles;\r\n                }\r\n                // Write\r\n                if (!(eecr & EEPM0)) {\r\n                    this.backend.writeMemory(addr, eedr);\r\n                    this.writeCompleteCycles += this.config.writeCycles;\r\n                }\r\n                this.cpu.data[EECR] |= EEPE;\r\n                this.cpu.addClockEvent(() => {\r\n                    this.cpu.setInterruptFlag(this.EER);\r\n                }, this.writeCompleteCycles - this.cpu.cycles);\r\n                // When EEPE has been set, the CPU is halted for two cycles before the\r\n                // next instruction is executed.\r\n                this.cpu.cycles += 2;\r\n            }\r\n            return true;\r\n        };\r\n    }\r\n}\r\n", "export const INT0 = {\r\n    EICR: 0x69,\r\n    EIMSK: 0x3d,\r\n    EIFR: 0x3c,\r\n    index: 0,\r\n    iscOffset: 0,\r\n    interrupt: 2,\r\n};\r\nexport const INT1 = {\r\n    EICR: 0x69,\r\n    EIMSK: 0x3d,\r\n    EIFR: 0x3c,\r\n    index: 1,\r\n    iscOffset: 2,\r\n    interrupt: 4,\r\n};\r\nexport const PCINT0 = {\r\n    PCIE: 0,\r\n    PCICR: 0x68,\r\n    PCIFR: 0x3b,\r\n    PCMSK: 0x6b,\r\n    pinChangeInterrupt: 6,\r\n    mask: 0xff,\r\n    offset: 0,\r\n};\r\nexport const PCINT1 = {\r\n    PCIE: 1,\r\n    PCICR: 0x68,\r\n    PCIFR: 0x3b,\r\n    PCMSK: 0x6c,\r\n    pinChangeInterrupt: 8,\r\n    mask: 0xff,\r\n    offset: 0,\r\n};\r\nexport const PCINT2 = {\r\n    PCIE: 2,\r\n    PCICR: 0x68,\r\n    PCIFR: 0x3b,\r\n    PCMSK: 0x6d,\r\n    pinChangeInterrupt: 10,\r\n    mask: 0xff,\r\n    offset: 0,\r\n};\r\nexport const portAConfig = {\r\n    PIN: 0x20,\r\n    DDR: 0x21,\r\n    PORT: 0x22,\r\n    externalInterrupts: [],\r\n};\r\nexport const portBConfig = {\r\n    PIN: 0x23,\r\n    DDR: 0x24,\r\n    PORT: 0x25,\r\n    // Interrupt settings\r\n    pinChange: PCINT0,\r\n    externalInterrupts: [],\r\n};\r\nexport const portCConfig = {\r\n    PIN: 0x26,\r\n    DDR: 0x27,\r\n    PORT: 0x28,\r\n    // Interrupt settings\r\n    pinChange: PCINT1,\r\n    externalInterrupts: [],\r\n};\r\nexport const portDConfig = {\r\n    PIN: 0x29,\r\n    DDR: 0x2a,\r\n    PORT: 0x2b,\r\n    // Interrupt settings\r\n    pinChange: PCINT2,\r\n    externalInterrupts: [null, null, INT0, INT1],\r\n};\r\nexport const portEConfig = {\r\n    PIN: 0x2c,\r\n    DDR: 0x2d,\r\n    PORT: 0x2e,\r\n    externalInterrupts: [],\r\n};\r\nexport const portFConfig = {\r\n    PIN: 0x2f,\r\n    DDR: 0x30,\r\n    PORT: 0x31,\r\n    externalInterrupts: [],\r\n};\r\nexport const portGConfig = {\r\n    PIN: 0x32,\r\n    DDR: 0x33,\r\n    PORT: 0x34,\r\n    externalInterrupts: [],\r\n};\r\nexport const portHConfig = {\r\n    PIN: 0x100,\r\n    DDR: 0x101,\r\n    PORT: 0x102,\r\n    externalInterrupts: [],\r\n};\r\nexport const portJConfig = {\r\n    PIN: 0x103,\r\n    DDR: 0x104,\r\n    PORT: 0x105,\r\n    externalInterrupts: [],\r\n};\r\nexport const portKConfig = {\r\n    PIN: 0x106,\r\n    DDR: 0x107,\r\n    PORT: 0x108,\r\n    externalInterrupts: [],\r\n};\r\nexport const portLConfig = {\r\n    PIN: 0x109,\r\n    DDR: 0x10a,\r\n    PORT: 0x10b,\r\n    externalInterrupts: [],\r\n};\r\nexport var PinState;\r\n(function (PinState) {\r\n    PinState[PinState[\"Low\"] = 0] = \"Low\";\r\n    PinState[PinState[\"High\"] = 1] = \"High\";\r\n    PinState[PinState[\"Input\"] = 2] = \"Input\";\r\n    PinState[PinState[\"InputPullUp\"] = 3] = \"InputPullUp\";\r\n})(PinState || (PinState = {}));\r\n/* This mechanism allows timers to override specific GPIO pins */\r\nexport var PinOverrideMode;\r\n(function (PinOverrideMode) {\r\n    PinOverrideMode[PinOverrideMode[\"None\"] = 0] = \"None\";\r\n    PinOverrideMode[PinOverrideMode[\"Enable\"] = 1] = \"Enable\";\r\n    PinOverrideMode[PinOverrideMode[\"Set\"] = 2] = \"Set\";\r\n    PinOverrideMode[PinOverrideMode[\"Clear\"] = 3] = \"Clear\";\r\n    PinOverrideMode[PinOverrideMode[\"Toggle\"] = 4] = \"Toggle\";\r\n})(PinOverrideMode || (PinOverrideMode = {}));\r\nvar InterruptMode;\r\n(function (InterruptMode) {\r\n    InterruptMode[InterruptMode[\"LowLevel\"] = 0] = \"LowLevel\";\r\n    InterruptMode[InterruptMode[\"Change\"] = 1] = \"Change\";\r\n    InterruptMode[InterruptMode[\"FallingEdge\"] = 2] = \"FallingEdge\";\r\n    InterruptMode[InterruptMode[\"RisingEdge\"] = 3] = \"RisingEdge\";\r\n})(InterruptMode || (InterruptMode = {}));\r\nexport class AVRIOPort {\r\n    constructor(cpu, portConfig) {\r\n        var _a, _b, _c, _d;\r\n        this.cpu = cpu;\r\n        this.portConfig = portConfig;\r\n        this.externalClockListeners = [];\r\n        this.listeners = [];\r\n        this.pinValue = 0;\r\n        this.overrideMask = 0xff;\r\n        this.overrideValue = 0;\r\n        this.lastValue = 0;\r\n        this.lastDdr = 0;\r\n        this.lastPin = 0;\r\n        this.openCollector = 0;\r\n        cpu.gpioPorts.add(this);\r\n        cpu.gpioByPort[portConfig.PORT] = this;\r\n        cpu.writeHooks[portConfig.DDR] = (value) => {\r\n            const portValue = cpu.data[portConfig.PORT];\r\n            cpu.data[portConfig.DDR] = value;\r\n            this.writeGpio(portValue, value);\r\n            this.updatePinRegister(value);\r\n            return true;\r\n        };\r\n        cpu.writeHooks[portConfig.PORT] = (value) => {\r\n            const ddrMask = cpu.data[portConfig.DDR];\r\n            cpu.data[portConfig.PORT] = value;\r\n            this.writeGpio(value, ddrMask);\r\n            this.updatePinRegister(ddrMask);\r\n            return true;\r\n        };\r\n        cpu.writeHooks[portConfig.PIN] = (value, oldValue, addr, mask) => {\r\n            // Writing to 1 PIN toggles PORT bits\r\n            const oldPortValue = cpu.data[portConfig.PORT];\r\n            const ddrMask = cpu.data[portConfig.DDR];\r\n            const portValue = oldPortValue ^ (value & mask);\r\n            cpu.data[portConfig.PORT] = portValue;\r\n            this.writeGpio(portValue, ddrMask);\r\n            this.updatePinRegister(ddrMask);\r\n            return true;\r\n        };\r\n        // External interrupts\r\n        const { externalInterrupts } = portConfig;\r\n        this.externalInts = externalInterrupts.map((externalConfig) => externalConfig\r\n            ? {\r\n                address: externalConfig.interrupt,\r\n                flagRegister: externalConfig.EIFR,\r\n                flagMask: 1 << externalConfig.index,\r\n                enableRegister: externalConfig.EIMSK,\r\n                enableMask: 1 << externalConfig.index,\r\n            }\r\n            : null);\r\n        const EICR = new Set(externalInterrupts.map((item) => item === null || item === void 0 ? void 0 : item.EICR));\r\n        for (const EICRx of EICR) {\r\n            this.attachInterruptHook(EICRx || 0);\r\n        }\r\n        const EIMSK = (_b = (_a = externalInterrupts.find((item) => item && item.EIMSK)) === null || _a === void 0 ? void 0 : _a.EIMSK) !== null && _b !== void 0 ? _b : 0;\r\n        this.attachInterruptHook(EIMSK, 'mask');\r\n        const EIFR = (_d = (_c = externalInterrupts.find((item) => item && item.EIFR)) === null || _c === void 0 ? void 0 : _c.EIFR) !== null && _d !== void 0 ? _d : 0;\r\n        this.attachInterruptHook(EIFR, 'flag');\r\n        // Pin change interrupts\r\n        const { pinChange } = portConfig;\r\n        this.PCINT = pinChange\r\n            ? {\r\n                address: pinChange.pinChangeInterrupt,\r\n                flagRegister: pinChange.PCIFR,\r\n                flagMask: 1 << pinChange.PCIE,\r\n                enableRegister: pinChange.PCICR,\r\n                enableMask: 1 << pinChange.PCIE,\r\n            }\r\n            : null;\r\n        if (pinChange) {\r\n            const { PCIFR, PCMSK } = pinChange;\r\n            cpu.writeHooks[PCIFR] = (value) => {\r\n                for (const gpio of this.cpu.gpioPorts) {\r\n                    const { PCINT } = gpio;\r\n                    if (PCINT) {\r\n                        cpu.clearInterruptByFlag(PCINT, value);\r\n                    }\r\n                }\r\n                return true;\r\n            };\r\n            cpu.writeHooks[PCMSK] = (value) => {\r\n                cpu.data[PCMSK] = value;\r\n                for (const gpio of this.cpu.gpioPorts) {\r\n                    const { PCINT } = gpio;\r\n                    if (PCINT) {\r\n                        cpu.updateInterruptEnable(PCINT, value);\r\n                    }\r\n                }\r\n                return true;\r\n            };\r\n        }\r\n    }\r\n    addListener(listener) {\r\n        this.listeners.push(listener);\r\n    }\r\n    removeListener(listener) {\r\n        this.listeners = this.listeners.filter((l) => l !== listener);\r\n    }\r\n    /**\r\n     * Get the state of a given GPIO pin\r\n     *\r\n     * @param index Pin index to return from 0 to 7\r\n     * @returns PinState.Low or PinState.High if the pin is set to output, PinState.Input if the pin is set\r\n     *   to input, and PinState.InputPullUp if the pin is set to input and the internal pull-up resistor has\r\n     *   been enabled.\r\n     */\r\n    pinState(index) {\r\n        const ddr = this.cpu.data[this.portConfig.DDR];\r\n        const port = this.cpu.data[this.portConfig.PORT];\r\n        const bitMask = 1 << index;\r\n        const openState = port & bitMask ? PinState.InputPullUp : PinState.Input;\r\n        const highValue = this.openCollector & bitMask ? openState : PinState.High;\r\n        if (ddr & bitMask) {\r\n            return this.lastValue & bitMask ? highValue : PinState.Low;\r\n        }\r\n        else {\r\n            return openState;\r\n        }\r\n    }\r\n    /**\r\n     * Sets the input value for the given pin. This is the value that\r\n     * will be returned when reading from the PIN register.\r\n     */\r\n    setPin(index, value) {\r\n        const bitMask = 1 << index;\r\n        this.pinValue &= ~bitMask;\r\n        if (value) {\r\n            this.pinValue |= bitMask;\r\n        }\r\n        this.updatePinRegister(this.cpu.data[this.portConfig.DDR]);\r\n    }\r\n    /**\r\n     * Internal method - do not call this directly!\r\n     * Used by the timer compare output units to override GPIO pins.\r\n     */\r\n    timerOverridePin(pin, mode) {\r\n        const { cpu, portConfig } = this;\r\n        const pinMask = 1 << pin;\r\n        if (mode === PinOverrideMode.None) {\r\n            this.overrideMask |= pinMask;\r\n            this.overrideValue &= ~pinMask;\r\n        }\r\n        else {\r\n            this.overrideMask &= ~pinMask;\r\n            switch (mode) {\r\n                case PinOverrideMode.Enable:\r\n                    this.overrideValue &= ~pinMask;\r\n                    this.overrideValue |= cpu.data[portConfig.PORT] & pinMask;\r\n                    break;\r\n                case PinOverrideMode.Set:\r\n                    this.overrideValue |= pinMask;\r\n                    break;\r\n                case PinOverrideMode.Clear:\r\n                    this.overrideValue &= ~pinMask;\r\n                    break;\r\n                case PinOverrideMode.Toggle:\r\n                    this.overrideValue ^= pinMask;\r\n                    break;\r\n            }\r\n        }\r\n        const ddrMask = cpu.data[portConfig.DDR];\r\n        this.writeGpio(cpu.data[portConfig.PORT], ddrMask);\r\n        this.updatePinRegister(ddrMask);\r\n    }\r\n    updatePinRegister(ddr) {\r\n        var _a, _b;\r\n        const newPin = (this.pinValue & ~ddr) | (this.lastValue & ddr);\r\n        this.cpu.data[this.portConfig.PIN] = newPin;\r\n        if (this.lastPin !== newPin) {\r\n            for (let index = 0; index < 8; index++) {\r\n                if ((newPin & (1 << index)) !== (this.lastPin & (1 << index))) {\r\n                    const value = !!(newPin & (1 << index));\r\n                    this.toggleInterrupt(index, value);\r\n                    (_b = (_a = this.externalClockListeners)[index]) === null || _b === void 0 ? void 0 : _b.call(_a, value);\r\n                }\r\n            }\r\n            this.lastPin = newPin;\r\n        }\r\n    }\r\n    toggleInterrupt(pin, risingEdge) {\r\n        const { cpu, portConfig, externalInts, PCINT } = this;\r\n        const { externalInterrupts, pinChange } = portConfig;\r\n        const externalConfig = externalInterrupts[pin];\r\n        const external = externalInts[pin];\r\n        if (external && externalConfig) {\r\n            const { EIMSK, index, EICR, iscOffset } = externalConfig;\r\n            if (cpu.data[EIMSK] & (1 << index)) {\r\n                const configuration = (cpu.data[EICR] >> iscOffset) & 0x3;\r\n                let generateInterrupt = false;\r\n                external.constant = false;\r\n                switch (configuration) {\r\n                    case InterruptMode.LowLevel:\r\n                        generateInterrupt = !risingEdge;\r\n                        external.constant = true;\r\n                        break;\r\n                    case InterruptMode.Change:\r\n                        generateInterrupt = true;\r\n                        break;\r\n                    case InterruptMode.FallingEdge:\r\n                        generateInterrupt = !risingEdge;\r\n                        break;\r\n                    case InterruptMode.RisingEdge:\r\n                        generateInterrupt = risingEdge;\r\n                        break;\r\n                }\r\n                if (generateInterrupt) {\r\n                    cpu.setInterruptFlag(external);\r\n                }\r\n                else if (external.constant) {\r\n                    cpu.clearInterrupt(external, true);\r\n                }\r\n            }\r\n        }\r\n        if (pinChange && PCINT && pinChange.mask & (1 << pin)) {\r\n            const { PCMSK } = pinChange;\r\n            if (cpu.data[PCMSK] & (1 << (pin + pinChange.offset))) {\r\n                cpu.setInterruptFlag(PCINT);\r\n            }\r\n        }\r\n    }\r\n    attachInterruptHook(register, registerType = 'other') {\r\n        if (!register) {\r\n            return;\r\n        }\r\n        const { cpu } = this;\r\n        cpu.writeHooks[register] = (value) => {\r\n            if (registerType !== 'flag') {\r\n                cpu.data[register] = value;\r\n            }\r\n            for (const gpio of cpu.gpioPorts) {\r\n                for (const external of gpio.externalInts) {\r\n                    if (external && registerType === 'mask') {\r\n                        cpu.updateInterruptEnable(external, value);\r\n                    }\r\n                    if (external && !external.constant && registerType === 'flag') {\r\n                        cpu.clearInterruptByFlag(external, value);\r\n                    }\r\n                }\r\n                gpio.checkExternalInterrupts();\r\n            }\r\n            return true;\r\n        };\r\n    }\r\n    checkExternalInterrupts() {\r\n        const { cpu } = this;\r\n        const { externalInterrupts } = this.portConfig;\r\n        for (let pin = 0; pin < 8; pin++) {\r\n            const external = externalInterrupts[pin];\r\n            if (!external) {\r\n                continue;\r\n            }\r\n            const pinValue = !!(this.lastPin & (1 << pin));\r\n            const { EIFR, EIMSK, index, EICR, iscOffset, interrupt } = external;\r\n            if (!(cpu.data[EIMSK] & (1 << index)) || pinValue) {\r\n                continue;\r\n            }\r\n            const configuration = (cpu.data[EICR] >> iscOffset) & 0x3;\r\n            if (configuration === InterruptMode.LowLevel) {\r\n                cpu.queueInterrupt({\r\n                    address: interrupt,\r\n                    flagRegister: EIFR,\r\n                    flagMask: 1 << index,\r\n                    enableRegister: EIMSK,\r\n                    enableMask: 1 << index,\r\n                    constant: true,\r\n                });\r\n            }\r\n        }\r\n    }\r\n    writeGpio(value, ddr) {\r\n        const newValue = (((value & this.overrideMask) | this.overrideValue) & ddr) | (value & ~ddr);\r\n        const prevValue = this.lastValue;\r\n        if (newValue !== prevValue || ddr !== this.lastDdr) {\r\n            this.lastValue = newValue;\r\n            this.lastDdr = ddr;\r\n            for (const listener of this.listeners) {\r\n                listener(newValue, prevValue);\r\n            }\r\n        }\r\n    }\r\n}\r\n", "// Register bits:\r\nconst SPCR_SPIE = 0x80; // SPI Interrupt Enable\r\nconst SPCR_SPE = 0x40; // SPI Enable\r\nconst SPCR_DORD = 0x20; // Data Order\r\nconst SPCR_MSTR = 0x10; // Master/Slave Select\r\nconst SPCR_CPOL = 0x8; // Clock Polarity\r\nconst SPCR_CPHA = 0x4; // Clock Phase\r\nconst SPCR_SPR1 = 0x2; // SPI Clock Rate Select 1\r\nconst SPCR_SPR0 = 0x1; // SPI Clock Rate Select 0\r\nconst SPSR_SPR_MASK = SPCR_SPR1 | SPCR_SPR0;\r\nconst SPSR_SPIF = 0x80; // SPI Interrupt Flag\r\nconst SPSR_WCOL = 0x40; // Write COLlision Flag\r\nconst SPSR_SPI2X = 0x1; // Double SPI Speed Bit\r\nexport const spiConfig = {\r\n    spiInterrupt: 0x22,\r\n    SPCR: 0x4c,\r\n    SPSR: 0x4d,\r\n    SPDR: 0x4e,\r\n};\r\nconst bitsPerByte = 8;\r\nexport class AVRSPI {\r\n    constructor(cpu, config, freqHz) {\r\n        this.cpu = cpu;\r\n        this.config = config;\r\n        this.freqHz = freqHz;\r\n        /** @deprecated Use onByte() instead */\r\n        this.onTransfer = () => 0;\r\n        /**\r\n         * SPI byte transfer callback. Invoked whenever the user code starts an SPI transaction.\r\n         * You can override this with your own SPI handler logic.\r\n         *\r\n         * The callback receives a argument: the byte sent over the SPI MOSI line.\r\n         * It should call `completeTransfer()` within `transferCycles` CPU cycles.\r\n         */\r\n        this.onByte = (value) => {\r\n            const valueIn = this.onTransfer(value);\r\n            this.cpu.addClockEvent(() => this.completeTransfer(valueIn), this.transferCycles);\r\n        };\r\n        this.transmissionActive = false;\r\n        // Interrupts\r\n        this.SPI = {\r\n            address: this.config.spiInterrupt,\r\n            flagRegister: this.config.SPSR,\r\n            flagMask: SPSR_SPIF,\r\n            enableRegister: this.config.SPCR,\r\n            enableMask: SPCR_SPIE,\r\n        };\r\n        const { SPCR, SPSR, SPDR } = config;\r\n        cpu.writeHooks[SPDR] = (value) => {\r\n            if (!(cpu.data[SPCR] & SPCR_SPE)) {\r\n                // SPI not enabled, ignore write\r\n                return;\r\n            }\r\n            // Write collision\r\n            if (this.transmissionActive) {\r\n                cpu.data[SPSR] |= SPSR_WCOL;\r\n                return true;\r\n            }\r\n            // Clear write collision / interrupt flags\r\n            cpu.data[SPSR] &= ~SPSR_WCOL;\r\n            this.cpu.clearInterrupt(this.SPI);\r\n            this.transmissionActive = true;\r\n            this.onByte(value);\r\n            return true;\r\n        };\r\n        cpu.writeHooks[SPCR] = (value) => {\r\n            this.cpu.updateInterruptEnable(this.SPI, value);\r\n        };\r\n        cpu.writeHooks[SPSR] = (value) => {\r\n            this.cpu.data[SPSR] = value;\r\n            this.cpu.clearInterruptByFlag(this.SPI, value);\r\n        };\r\n    }\r\n    reset() {\r\n        this.transmissionActive = false;\r\n    }\r\n    /**\r\n     * Completes an SPI transaction. Call this method only from the `onByte` callback.\r\n     *\r\n     * @param receivedByte Byte read from the SPI MISO line.\r\n     */\r\n    completeTransfer(receivedByte) {\r\n        const { SPDR } = this.config;\r\n        this.cpu.data[SPDR] = receivedByte;\r\n        this.cpu.setInterruptFlag(this.SPI);\r\n        this.transmissionActive = false;\r\n    }\r\n    get isMaster() {\r\n        return this.cpu.data[this.config.SPCR] & SPCR_MSTR ? true : false;\r\n    }\r\n    get dataOrder() {\r\n        return this.cpu.data[this.config.SPCR] & SPCR_DORD ? 'lsbFirst' : 'msbFirst';\r\n    }\r\n    get spiMode() {\r\n        const CPHA = this.cpu.data[this.config.SPCR] & SPCR_CPHA;\r\n        const CPOL = this.cpu.data[this.config.SPCR] & SPCR_CPOL;\r\n        return ((CPHA ? 2 : 0) | (CPOL ? 1 : 0));\r\n    }\r\n    /**\r\n     * The clock divider is only relevant for Master mode\r\n     */\r\n    get clockDivider() {\r\n        const base = this.cpu.data[this.config.SPSR] & SPSR_SPI2X ? 2 : 4;\r\n        switch (this.cpu.data[this.config.SPCR] & SPSR_SPR_MASK) {\r\n            case 0b00:\r\n                return base;\r\n            case 0b01:\r\n                return base * 4;\r\n            case 0b10:\r\n                return base * 16;\r\n            case 0b11:\r\n                return base * 32;\r\n        }\r\n        // We should never get here:\r\n        throw new Error('Invalid divider value!');\r\n    }\r\n    /** Number of cycles to complete a single byte SPI transaction */\r\n    get transferCycles() {\r\n        return this.clockDivider * bitsPerByte;\r\n    }\r\n    /**\r\n     * The SPI freqeuncy is only relevant to Master mode.\r\n     * In slave mode, the frequency can be as high as F(osc) / 4.\r\n     */\r\n    get spiFrequency() {\r\n        return this.freqHz / this.clockDivider;\r\n    }\r\n}\r\n", "/**\r\n * AVR-8 Timers\r\n * Part of AVR8js\r\n * Reference: http://ww1.microchip.com/downloads/en/DeviceDoc/ATmega48A-PA-88A-PA-168A-PA-328-P-DS-DS40002061A.pdf\r\n *\r\n * Copyright (C) 2019, 2020, 2021 Uri Shaked\r\n */\r\nimport { PinOverrideMode, portBConfig, portDConfig } from './gpio';\r\nconst timer01Dividers = {\r\n    0: 0,\r\n    1: 1,\r\n    2: 8,\r\n    3: 64,\r\n    4: 256,\r\n    5: 1024,\r\n    6: 0,\r\n    7: 0, // Ditto\r\n};\r\nvar ExternalClockMode;\r\n(function (ExternalClockMode) {\r\n    ExternalClockMode[ExternalClockMode[\"FallingEdge\"] = 6] = \"FallingEdge\";\r\n    ExternalClockMode[ExternalClockMode[\"RisingEdge\"] = 7] = \"RisingEdge\";\r\n})(ExternalClockMode || (ExternalClockMode = {}));\r\n/** These are differnet for some devices (e.g. ATtiny85) */\r\nconst defaultTimerBits = {\r\n    // TIFR bits\r\n    TOV: 1,\r\n    OCFA: 2,\r\n    OCFB: 4,\r\n    OCFC: 0,\r\n    // TIMSK bits\r\n    TOIE: 1,\r\n    OCIEA: 2,\r\n    OCIEB: 4,\r\n    OCIEC: 0, // Unused\r\n};\r\nexport const timer0Config = Object.assign({ bits: 8, captureInterrupt: 0, compAInterrupt: 0x1c, compBInterrupt: 0x1e, compCInterrupt: 0, ovfInterrupt: 0x20, TIFR: 0x35, OCRA: 0x47, OCRB: 0x48, OCRC: 0, ICR: 0, TCNT: 0x46, TCCRA: 0x44, TCCRB: 0x45, TCCRC: 0, TIMSK: 0x6e, dividers: timer01Dividers, compPortA: portDConfig.PORT, compPinA: 6, compPortB: portDConfig.PORT, compPinB: 5, compPortC: 0, compPinC: 0, externalClockPort: portDConfig.PORT, externalClockPin: 4 }, defaultTimerBits);\r\nexport const timer1Config = Object.assign({ bits: 16, captureInterrupt: 0x14, compAInterrupt: 0x16, compBInterrupt: 0x18, compCInterrupt: 0, ovfInterrupt: 0x1a, TIFR: 0x36, OCRA: 0x88, OCRB: 0x8a, OCRC: 0, ICR: 0x86, TCNT: 0x84, TCCRA: 0x80, TCCRB: 0x81, TCCRC: 0x82, TIMSK: 0x6f, dividers: timer01Dividers, compPortA: portBConfig.PORT, compPinA: 1, compPortB: portBConfig.PORT, compPinB: 2, compPortC: 0, compPinC: 0, externalClockPort: portDConfig.PORT, externalClockPin: 5 }, defaultTimerBits);\r\nexport const timer2Config = Object.assign({ bits: 8, captureInterrupt: 0, compAInterrupt: 0x0e, compBInterrupt: 0x10, compCInterrupt: 0, ovfInterrupt: 0x12, TIFR: 0x37, OCRA: 0xb3, OCRB: 0xb4, OCRC: 0, ICR: 0, TCNT: 0xb2, TCCRA: 0xb0, TCCRB: 0xb1, TCCRC: 0, TIMSK: 0x70, dividers: {\r\n        0: 0,\r\n        1: 1,\r\n        2: 8,\r\n        3: 32,\r\n        4: 64,\r\n        5: 128,\r\n        6: 256,\r\n        7: 1024,\r\n    }, compPortA: portBConfig.PORT, compPinA: 3, compPortB: portDConfig.PORT, compPinB: 3, compPortC: 0, compPinC: 0, externalClockPort: 0, externalClockPin: 0 }, defaultTimerBits);\r\n/* All the following types and constants are related to WGM (Waveform Generation Mode) bits: */\r\nvar TimerMode;\r\n(function (TimerMode) {\r\n    TimerMode[TimerMode[\"Normal\"] = 0] = \"Normal\";\r\n    TimerMode[TimerMode[\"PWMPhaseCorrect\"] = 1] = \"PWMPhaseCorrect\";\r\n    TimerMode[TimerMode[\"CTC\"] = 2] = \"CTC\";\r\n    TimerMode[TimerMode[\"FastPWM\"] = 3] = \"FastPWM\";\r\n    TimerMode[TimerMode[\"PWMPhaseFrequencyCorrect\"] = 4] = \"PWMPhaseFrequencyCorrect\";\r\n    TimerMode[TimerMode[\"Reserved\"] = 5] = \"Reserved\";\r\n})(TimerMode || (TimerMode = {}));\r\nvar TOVUpdateMode;\r\n(function (TOVUpdateMode) {\r\n    TOVUpdateMode[TOVUpdateMode[\"Max\"] = 0] = \"Max\";\r\n    TOVUpdateMode[TOVUpdateMode[\"Top\"] = 1] = \"Top\";\r\n    TOVUpdateMode[TOVUpdateMode[\"Bottom\"] = 2] = \"Bottom\";\r\n})(TOVUpdateMode || (TOVUpdateMode = {}));\r\nvar OCRUpdateMode;\r\n(function (OCRUpdateMode) {\r\n    OCRUpdateMode[OCRUpdateMode[\"Immediate\"] = 0] = \"Immediate\";\r\n    OCRUpdateMode[OCRUpdateMode[\"Top\"] = 1] = \"Top\";\r\n    OCRUpdateMode[OCRUpdateMode[\"Bottom\"] = 2] = \"Bottom\";\r\n})(OCRUpdateMode || (OCRUpdateMode = {}));\r\nconst TopOCRA = 1;\r\nconst TopICR = 2;\r\n// Enable Toggle mode for OCxA in PWM Wave Generation mode\r\nconst OCToggle = 1;\r\nconst { Normal, PWMPhaseCorrect, CTC, FastPWM, Reserved, PWMPhaseFrequencyCorrect } = TimerMode;\r\nconst wgmModes8Bit = [\r\n    /*0*/ [Normal, 0xff, OCRUpdateMode.Immediate, TOVUpdateMode.Max, 0],\r\n    /*1*/ [PWMPhaseCorrect, 0xff, OCRUpdateMode.Top, TOVUpdateMode.Bottom, 0],\r\n    /*2*/ [CTC, TopOCRA, OCRUpdateMode.Immediate, TOVUpdateMode.Max, 0],\r\n    /*3*/ [FastPWM, 0xff, OCRUpdateMode.Bottom, TOVUpdateMode.Max, 0],\r\n    /*4*/ [Reserved, 0xff, OCRUpdateMode.Immediate, TOVUpdateMode.Max, 0],\r\n    /*5*/ [PWMPhaseCorrect, TopOCRA, OCRUpdateMode.Top, TOVUpdateMode.Bottom, OCToggle],\r\n    /*6*/ [Reserved, 0xff, OCRUpdateMode.Immediate, TOVUpdateMode.Max, 0],\r\n    /*7*/ [FastPWM, TopOCRA, OCRUpdateMode.Bottom, TOVUpdateMode.Top, OCToggle],\r\n];\r\n// Table 16-4 in the datasheet\r\nconst wgmModes16Bit = [\r\n    /*0 */ [Normal, 0xffff, OCRUpdateMode.Immediate, TOVUpdateMode.Max, 0],\r\n    /*1 */ [PWMPhaseCorrect, 0x00ff, OCRUpdateMode.Top, TOVUpdateMode.Bottom, 0],\r\n    /*2 */ [PWMPhaseCorrect, 0x01ff, OCRUpdateMode.Top, TOVUpdateMode.Bottom, 0],\r\n    /*3 */ [PWMPhaseCorrect, 0x03ff, OCRUpdateMode.Top, TOVUpdateMode.Bottom, 0],\r\n    /*4 */ [CTC, TopOCRA, OCRUpdateMode.Immediate, TOVUpdateMode.Max, 0],\r\n    /*5 */ [FastPWM, 0x00ff, OCRUpdateMode.Bottom, TOVUpdateMode.Top, 0],\r\n    /*6 */ [FastPWM, 0x01ff, OCRUpdateMode.Bottom, TOVUpdateMode.Top, 0],\r\n    /*7 */ [FastPWM, 0x03ff, OCRUpdateMode.Bottom, TOVUpdateMode.Top, 0],\r\n    /*8 */ [PWMPhaseFrequencyCorrect, TopICR, OCRUpdateMode.Bottom, TOVUpdateMode.Bottom, 0],\r\n    /*9 */ [PWMPhaseFrequencyCorrect, TopOCRA, OCRUpdateMode.Bottom, TOVUpdateMode.Bottom, OCToggle],\r\n    /*10*/ [PWMPhaseCorrect, TopICR, OCRUpdateMode.Top, TOVUpdateMode.Bottom, 0],\r\n    /*11*/ [PWMPhaseCorrect, TopOCRA, OCRUpdateMode.Top, TOVUpdateMode.Bottom, OCToggle],\r\n    /*12*/ [CTC, TopICR, OCRUpdateMode.Immediate, TOVUpdateMode.Max, 0],\r\n    /*13*/ [Reserved, 0xffff, OCRUpdateMode.Immediate, TOVUpdateMode.Max, 0],\r\n    /*14*/ [FastPWM, TopICR, OCRUpdateMode.Bottom, TOVUpdateMode.Top, OCToggle],\r\n    /*15*/ [FastPWM, TopOCRA, OCRUpdateMode.Bottom, TOVUpdateMode.Top, OCToggle],\r\n];\r\nfunction compToOverride(comp) {\r\n    switch (comp) {\r\n        case 1:\r\n            return PinOverrideMode.Toggle;\r\n        case 2:\r\n            return PinOverrideMode.Clear;\r\n        case 3:\r\n            return PinOverrideMode.Set;\r\n        default:\r\n            return PinOverrideMode.Enable;\r\n    }\r\n}\r\n// Force Output Compare (FOC) bits\r\nconst FOCA = 1 << 7;\r\nconst FOCB = 1 << 6;\r\nconst FOCC = 1 << 5;\r\nexport class AVRTimer {\r\n    constructor(cpu, config) {\r\n        this.cpu = cpu;\r\n        this.config = config;\r\n        this.MAX = this.config.bits === 16 ? 0xffff : 0xff;\r\n        this.lastCycle = 0;\r\n        this.ocrA = 0;\r\n        this.nextOcrA = 0;\r\n        this.ocrB = 0;\r\n        this.nextOcrB = 0;\r\n        this.hasOCRC = this.config.OCRC > 0;\r\n        this.ocrC = 0;\r\n        this.nextOcrC = 0;\r\n        this.ocrUpdateMode = OCRUpdateMode.Immediate;\r\n        this.tovUpdateMode = TOVUpdateMode.Max;\r\n        this.icr = 0; // only for 16-bit timers\r\n        this.tcnt = 0;\r\n        this.tcntNext = 0;\r\n        this.tcntUpdated = false;\r\n        this.updateDivider = false;\r\n        this.countingUp = true;\r\n        this.divider = 0;\r\n        this.externalClockRisingEdge = false;\r\n        // This is the temporary register used to access 16-bit registers (section 16.3 of the datasheet)\r\n        this.highByteTemp = 0;\r\n        // Interrupts\r\n        this.OVF = {\r\n            address: this.config.ovfInterrupt,\r\n            flagRegister: this.config.TIFR,\r\n            flagMask: this.config.TOV,\r\n            enableRegister: this.config.TIMSK,\r\n            enableMask: this.config.TOIE,\r\n        };\r\n        this.OCFA = {\r\n            address: this.config.compAInterrupt,\r\n            flagRegister: this.config.TIFR,\r\n            flagMask: this.config.OCFA,\r\n            enableRegister: this.config.TIMSK,\r\n            enableMask: this.config.OCIEA,\r\n        };\r\n        this.OCFB = {\r\n            address: this.config.compBInterrupt,\r\n            flagRegister: this.config.TIFR,\r\n            flagMask: this.config.OCFB,\r\n            enableRegister: this.config.TIMSK,\r\n            enableMask: this.config.OCIEB,\r\n        };\r\n        this.OCFC = {\r\n            address: this.config.compCInterrupt,\r\n            flagRegister: this.config.TIFR,\r\n            flagMask: this.config.OCFC,\r\n            enableRegister: this.config.TIMSK,\r\n            enableMask: this.config.OCIEC,\r\n        };\r\n        this.count = (reschedule = true, external = false) => {\r\n            const { divider, lastCycle, cpu } = this;\r\n            const { cycles } = cpu;\r\n            const delta = cycles - lastCycle;\r\n            if ((divider && delta >= divider) || external) {\r\n                const counterDelta = external ? 1 : Math.floor(delta / divider);\r\n                this.lastCycle += counterDelta * divider;\r\n                const val = this.tcnt;\r\n                const { timerMode, TOP } = this;\r\n                const phasePwm = timerMode === PWMPhaseCorrect || timerMode === PWMPhaseFrequencyCorrect;\r\n                const newVal = phasePwm\r\n                    ? this.phasePwmCount(val, counterDelta)\r\n                    : (val + counterDelta) % (TOP + 1);\r\n                const overflow = val + counterDelta > TOP;\r\n                // A CPU write overrides (has priority over) all counter clear or count operations.\r\n                if (!this.tcntUpdated) {\r\n                    this.tcnt = newVal;\r\n                    if (!phasePwm) {\r\n                        this.timerUpdated(newVal, val);\r\n                    }\r\n                }\r\n                if (!phasePwm) {\r\n                    if (timerMode === FastPWM && overflow) {\r\n                        const { compA, compB } = this;\r\n                        if (compA) {\r\n                            this.updateCompPin(compA, 'A', true);\r\n                        }\r\n                        if (compB) {\r\n                            this.updateCompPin(compB, 'B', true);\r\n                        }\r\n                    }\r\n                    if (this.ocrUpdateMode == OCRUpdateMode.Bottom && overflow) {\r\n                        // OCRUpdateMode.Top only occurs in Phase Correct modes, handled by phasePwmCount()\r\n                        this.ocrA = this.nextOcrA;\r\n                        this.ocrB = this.nextOcrB;\r\n                        this.ocrC = this.nextOcrC;\r\n                    }\r\n                    // OCRUpdateMode.Bottom only occurs in Phase Correct modes, handled by phasePwmCount().\r\n                    // Thus we only handle TOVUpdateMode.Top or TOVUpdateMode.Max here.\r\n                    if (overflow && (this.tovUpdateMode == TOVUpdateMode.Top || TOP === this.MAX)) {\r\n                        cpu.setInterruptFlag(this.OVF);\r\n                    }\r\n                }\r\n            }\r\n            if (this.tcntUpdated) {\r\n                this.tcnt = this.tcntNext;\r\n                this.tcntUpdated = false;\r\n                if ((this.tcnt === 0 && this.ocrUpdateMode === OCRUpdateMode.Bottom) ||\r\n                    (this.tcnt === this.TOP && this.ocrUpdateMode === OCRUpdateMode.Top)) {\r\n                    this.ocrA = this.nextOcrA;\r\n                    this.ocrB = this.nextOcrB;\r\n                    this.ocrC = this.nextOcrC;\r\n                }\r\n            }\r\n            if (this.updateDivider) {\r\n                const { CS } = this;\r\n                const { externalClockPin } = this.config;\r\n                const newDivider = this.config.dividers[CS];\r\n                this.lastCycle = newDivider ? this.cpu.cycles : 0;\r\n                this.updateDivider = false;\r\n                this.divider = newDivider;\r\n                if (this.config.externalClockPort && !this.externalClockPort) {\r\n                    this.externalClockPort = this.cpu.gpioByPort[this.config.externalClockPort];\r\n                }\r\n                if (this.externalClockPort) {\r\n                    this.externalClockPort.externalClockListeners[externalClockPin] = null;\r\n                }\r\n                if (newDivider) {\r\n                    cpu.addClockEvent(this.count, this.lastCycle + newDivider - cpu.cycles);\r\n                }\r\n                else if (this.externalClockPort &&\r\n                    (CS === ExternalClockMode.FallingEdge || CS === ExternalClockMode.RisingEdge)) {\r\n                    this.externalClockPort.externalClockListeners[externalClockPin] =\r\n                        this.externalClockCallback;\r\n                    this.externalClockRisingEdge = CS === ExternalClockMode.RisingEdge;\r\n                }\r\n                return;\r\n            }\r\n            if (reschedule && divider) {\r\n                cpu.addClockEvent(this.count, this.lastCycle + divider - cpu.cycles);\r\n            }\r\n        };\r\n        this.externalClockCallback = (value) => {\r\n            if (value === this.externalClockRisingEdge) {\r\n                this.count(false, true);\r\n            }\r\n        };\r\n        this.updateWGMConfig();\r\n        this.cpu.readHooks[config.TCNT] = (addr) => {\r\n            this.count(false);\r\n            if (this.config.bits === 16) {\r\n                this.cpu.data[addr + 1] = this.tcnt >> 8;\r\n            }\r\n            return (this.cpu.data[addr] = this.tcnt & 0xff);\r\n        };\r\n        this.cpu.writeHooks[config.TCNT] = (value) => {\r\n            this.tcntNext = (this.highByteTemp << 8) | value;\r\n            this.countingUp = true;\r\n            this.tcntUpdated = true;\r\n            this.cpu.updateClockEvent(this.count, 0);\r\n            if (this.divider) {\r\n                this.timerUpdated(this.tcntNext, this.tcntNext);\r\n            }\r\n        };\r\n        this.cpu.writeHooks[config.OCRA] = (value) => {\r\n            this.nextOcrA = (this.highByteTemp << 8) | value;\r\n            if (this.ocrUpdateMode === OCRUpdateMode.Immediate) {\r\n                this.ocrA = this.nextOcrA;\r\n            }\r\n        };\r\n        this.cpu.writeHooks[config.OCRB] = (value) => {\r\n            this.nextOcrB = (this.highByteTemp << 8) | value;\r\n            if (this.ocrUpdateMode === OCRUpdateMode.Immediate) {\r\n                this.ocrB = this.nextOcrB;\r\n            }\r\n        };\r\n        if (this.hasOCRC) {\r\n            this.cpu.writeHooks[config.OCRC] = (value) => {\r\n                this.nextOcrC = (this.highByteTemp << 8) | value;\r\n                if (this.ocrUpdateMode === OCRUpdateMode.Immediate) {\r\n                    this.ocrC = this.nextOcrC;\r\n                }\r\n            };\r\n        }\r\n        if (this.config.bits === 16) {\r\n            this.cpu.writeHooks[config.ICR] = (value) => {\r\n                this.icr = (this.highByteTemp << 8) | value;\r\n            };\r\n            const updateTempRegister = (value) => {\r\n                this.highByteTemp = value;\r\n            };\r\n            const updateOCRHighRegister = (value, old, addr) => {\r\n                this.highByteTemp = value & (this.ocrMask >> 8);\r\n                cpu.data[addr] = this.highByteTemp;\r\n                return true;\r\n            };\r\n            this.cpu.writeHooks[config.TCNT + 1] = updateTempRegister;\r\n            this.cpu.writeHooks[config.OCRA + 1] = updateOCRHighRegister;\r\n            this.cpu.writeHooks[config.OCRB + 1] = updateOCRHighRegister;\r\n            if (this.hasOCRC) {\r\n                this.cpu.writeHooks[config.OCRC + 1] = updateOCRHighRegister;\r\n            }\r\n            this.cpu.writeHooks[config.ICR + 1] = updateTempRegister;\r\n        }\r\n        cpu.writeHooks[config.TCCRA] = (value) => {\r\n            this.cpu.data[config.TCCRA] = value;\r\n            this.updateWGMConfig();\r\n            return true;\r\n        };\r\n        cpu.writeHooks[config.TCCRB] = (value) => {\r\n            if (!config.TCCRC) {\r\n                this.checkForceCompare(value);\r\n                value &= ~(FOCA | FOCB);\r\n            }\r\n            this.cpu.data[config.TCCRB] = value;\r\n            this.updateDivider = true;\r\n            this.cpu.clearClockEvent(this.count);\r\n            this.cpu.addClockEvent(this.count, 0);\r\n            this.updateWGMConfig();\r\n            return true;\r\n        };\r\n        if (config.TCCRC) {\r\n            cpu.writeHooks[config.TCCRC] = (value) => {\r\n                this.checkForceCompare(value);\r\n            };\r\n        }\r\n        cpu.writeHooks[config.TIFR] = (value) => {\r\n            this.cpu.data[config.TIFR] = value;\r\n            this.cpu.clearInterruptByFlag(this.OVF, value);\r\n            this.cpu.clearInterruptByFlag(this.OCFA, value);\r\n            this.cpu.clearInterruptByFlag(this.OCFB, value);\r\n            return true;\r\n        };\r\n        cpu.writeHooks[config.TIMSK] = (value) => {\r\n            this.cpu.updateInterruptEnable(this.OVF, value);\r\n            this.cpu.updateInterruptEnable(this.OCFA, value);\r\n            this.cpu.updateInterruptEnable(this.OCFB, value);\r\n        };\r\n    }\r\n    reset() {\r\n        this.divider = 0;\r\n        this.lastCycle = 0;\r\n        this.ocrA = 0;\r\n        this.nextOcrA = 0;\r\n        this.ocrB = 0;\r\n        this.nextOcrB = 0;\r\n        this.ocrC = 0;\r\n        this.nextOcrC = 0;\r\n        this.icr = 0;\r\n        this.tcnt = 0;\r\n        this.tcntNext = 0;\r\n        this.tcntUpdated = false;\r\n        this.countingUp = false;\r\n        this.updateDivider = true;\r\n    }\r\n    get TCCRA() {\r\n        return this.cpu.data[this.config.TCCRA];\r\n    }\r\n    get TCCRB() {\r\n        return this.cpu.data[this.config.TCCRB];\r\n    }\r\n    get TIMSK() {\r\n        return this.cpu.data[this.config.TIMSK];\r\n    }\r\n    get CS() {\r\n        return (this.TCCRB & 0x7);\r\n    }\r\n    get WGM() {\r\n        const mask = this.config.bits === 16 ? 0x18 : 0x8;\r\n        return ((this.TCCRB & mask) >> 1) | (this.TCCRA & 0x3);\r\n    }\r\n    get TOP() {\r\n        switch (this.topValue) {\r\n            case TopOCRA:\r\n                return this.ocrA;\r\n            case TopICR:\r\n                return this.icr;\r\n            default:\r\n                return this.topValue;\r\n        }\r\n    }\r\n    get ocrMask() {\r\n        switch (this.topValue) {\r\n            case TopOCRA:\r\n            case TopICR:\r\n                return 0xffff;\r\n            default:\r\n                return this.topValue;\r\n        }\r\n    }\r\n    /** Expose the raw value of TCNT, for use by the unit tests */\r\n    get debugTCNT() {\r\n        return this.tcnt;\r\n    }\r\n    updateWGMConfig() {\r\n        const { config, WGM } = this;\r\n        const wgmModes = config.bits === 16 ? wgmModes16Bit : wgmModes8Bit;\r\n        const TCCRA = this.cpu.data[config.TCCRA];\r\n        const [timerMode, topValue, ocrUpdateMode, tovUpdateMode, flags] = wgmModes[WGM];\r\n        this.timerMode = timerMode;\r\n        this.topValue = topValue;\r\n        this.ocrUpdateMode = ocrUpdateMode;\r\n        this.tovUpdateMode = tovUpdateMode;\r\n        const pwmMode = timerMode === FastPWM ||\r\n            timerMode === PWMPhaseCorrect ||\r\n            timerMode === PWMPhaseFrequencyCorrect;\r\n        const prevCompA = this.compA;\r\n        this.compA = ((TCCRA >> 6) & 0x3);\r\n        if (this.compA === 1 && pwmMode && !(flags & OCToggle)) {\r\n            this.compA = 0;\r\n        }\r\n        if (!!prevCompA !== !!this.compA) {\r\n            this.updateCompA(this.compA ? PinOverrideMode.Enable : PinOverrideMode.None);\r\n        }\r\n        const prevCompB = this.compB;\r\n        this.compB = ((TCCRA >> 4) & 0x3);\r\n        if (this.compB === 1 && pwmMode) {\r\n            this.compB = 0; // Reserved, according to the datasheet\r\n        }\r\n        if (!!prevCompB !== !!this.compB) {\r\n            this.updateCompB(this.compB ? PinOverrideMode.Enable : PinOverrideMode.None);\r\n        }\r\n        if (this.hasOCRC) {\r\n            const prevCompC = this.compC;\r\n            this.compC = ((TCCRA >> 2) & 0x3);\r\n            if (this.compC === 1 && pwmMode) {\r\n                this.compC = 0; // Reserved, according to the datasheet\r\n            }\r\n            if (!!prevCompC !== !!this.compC) {\r\n                this.updateCompC(this.compC ? PinOverrideMode.Enable : PinOverrideMode.None);\r\n            }\r\n        }\r\n    }\r\n    phasePwmCount(value, delta) {\r\n        const { ocrA, ocrB, ocrC, hasOCRC, TOP, MAX, tcntUpdated } = this;\r\n        if (!value && !TOP) {\r\n            delta = 0;\r\n            if (this.ocrUpdateMode === OCRUpdateMode.Top) {\r\n                this.ocrA = this.nextOcrA;\r\n                this.ocrB = this.nextOcrB;\r\n                this.ocrC = this.nextOcrC;\r\n            }\r\n        }\r\n        while (delta > 0) {\r\n            if (this.countingUp) {\r\n                value++;\r\n                if (value === TOP && !tcntUpdated) {\r\n                    this.countingUp = false;\r\n                    if (this.ocrUpdateMode === OCRUpdateMode.Top) {\r\n                        this.ocrA = this.nextOcrA;\r\n                        this.ocrB = this.nextOcrB;\r\n                        this.ocrC = this.nextOcrC;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                value--;\r\n                if (!value && !tcntUpdated) {\r\n                    this.countingUp = true;\r\n                    this.cpu.setInterruptFlag(this.OVF);\r\n                    if (this.ocrUpdateMode === OCRUpdateMode.Bottom) {\r\n                        this.ocrA = this.nextOcrA;\r\n                        this.ocrB = this.nextOcrB;\r\n                        this.ocrC = this.nextOcrC;\r\n                    }\r\n                }\r\n            }\r\n            if (!tcntUpdated) {\r\n                if (value === ocrA) {\r\n                    this.cpu.setInterruptFlag(this.OCFA);\r\n                    if (this.compA) {\r\n                        this.updateCompPin(this.compA, 'A');\r\n                    }\r\n                }\r\n                if (value === ocrB) {\r\n                    this.cpu.setInterruptFlag(this.OCFB);\r\n                    if (this.compB) {\r\n                        this.updateCompPin(this.compB, 'B');\r\n                    }\r\n                }\r\n                if (hasOCRC && value === ocrC) {\r\n                    this.cpu.setInterruptFlag(this.OCFC);\r\n                    if (this.compC) {\r\n                        this.updateCompPin(this.compC, 'C');\r\n                    }\r\n                }\r\n            }\r\n            delta--;\r\n        }\r\n        return value & MAX;\r\n    }\r\n    timerUpdated(value, prevValue) {\r\n        const { ocrA, ocrB, ocrC, hasOCRC } = this;\r\n        const overflow = prevValue > value;\r\n        if (((prevValue < ocrA || overflow) && value >= ocrA) || (prevValue < ocrA && overflow)) {\r\n            this.cpu.setInterruptFlag(this.OCFA);\r\n            if (this.compA) {\r\n                this.updateCompPin(this.compA, 'A');\r\n            }\r\n        }\r\n        if (((prevValue < ocrB || overflow) && value >= ocrB) || (prevValue < ocrB && overflow)) {\r\n            this.cpu.setInterruptFlag(this.OCFB);\r\n            if (this.compB) {\r\n                this.updateCompPin(this.compB, 'B');\r\n            }\r\n        }\r\n        if (hasOCRC &&\r\n            (((prevValue < ocrC || overflow) && value >= ocrC) || (prevValue < ocrC && overflow))) {\r\n            this.cpu.setInterruptFlag(this.OCFC);\r\n            if (this.compC) {\r\n                this.updateCompPin(this.compC, 'C');\r\n            }\r\n        }\r\n    }\r\n    checkForceCompare(value) {\r\n        if (this.timerMode == TimerMode.FastPWM ||\r\n            this.timerMode == TimerMode.PWMPhaseCorrect ||\r\n            this.timerMode == TimerMode.PWMPhaseFrequencyCorrect) {\r\n            // The FOCnA/FOCnB/FOCnC bits are only active when the WGMn3:0 bits specifies a non-PWM mode\r\n            return;\r\n        }\r\n        if (value & FOCA) {\r\n            this.updateCompPin(this.compA, 'A');\r\n        }\r\n        if (value & FOCB) {\r\n            this.updateCompPin(this.compB, 'B');\r\n        }\r\n        if (this.config.compPortC && value & FOCC) {\r\n            this.updateCompPin(this.compC, 'C');\r\n        }\r\n    }\r\n    updateCompPin(compValue, pinName, bottom = false) {\r\n        let newValue = PinOverrideMode.None;\r\n        const invertingMode = compValue === 3;\r\n        const isSet = this.countingUp === invertingMode;\r\n        switch (this.timerMode) {\r\n            case Normal:\r\n            case CTC:\r\n                newValue = compToOverride(compValue);\r\n                break;\r\n            case FastPWM:\r\n                if (compValue === 1) {\r\n                    newValue = bottom ? PinOverrideMode.None : PinOverrideMode.Toggle;\r\n                }\r\n                else {\r\n                    newValue = invertingMode !== bottom ? PinOverrideMode.Set : PinOverrideMode.Clear;\r\n                }\r\n                break;\r\n            case PWMPhaseCorrect:\r\n            case PWMPhaseFrequencyCorrect:\r\n                if (compValue === 1) {\r\n                    newValue = PinOverrideMode.Toggle;\r\n                }\r\n                else {\r\n                    newValue = isSet ? PinOverrideMode.Set : PinOverrideMode.Clear;\r\n                }\r\n                break;\r\n        }\r\n        if (newValue !== PinOverrideMode.None) {\r\n            if (pinName === 'A') {\r\n                this.updateCompA(newValue);\r\n            }\r\n            else if (pinName === 'B') {\r\n                this.updateCompB(newValue);\r\n            }\r\n            else {\r\n                this.updateCompC(newValue);\r\n            }\r\n        }\r\n    }\r\n    updateCompA(value) {\r\n        const { compPortA, compPinA } = this.config;\r\n        const port = this.cpu.gpioByPort[compPortA];\r\n        port === null || port === void 0 ? void 0 : port.timerOverridePin(compPinA, value);\r\n    }\r\n    updateCompB(value) {\r\n        const { compPortB, compPinB } = this.config;\r\n        const port = this.cpu.gpioByPort[compPortB];\r\n        port === null || port === void 0 ? void 0 : port.timerOverridePin(compPinB, value);\r\n    }\r\n    updateCompC(value) {\r\n        const { compPortC, compPinC } = this.config;\r\n        const port = this.cpu.gpioByPort[compPortC];\r\n        port === null || port === void 0 ? void 0 : port.timerOverridePin(compPinC, value);\r\n    }\r\n}\r\n", "/* eslint-disable @typescript-eslint/no-unused-vars */\r\n// Register bits:\r\nconst TWCR_TWINT = 0x80; // TWI Interrupt Flag\r\nconst TWCR_TWEA = 0x40; // TWI Enable Acknowledge Bit\r\nconst TWCR_TWSTA = 0x20; // TWI START Condition Bit\r\nconst TWCR_TWSTO = 0x10; // TWI STOP Condition Bit\r\nconst TWCR_TWWC = 0x8; //TWI Write Collision Flag\r\nconst TWCR_TWEN = 0x4; //  TWI Enable Bit\r\nconst TWCR_TWIE = 0x1; // TWI Interrupt Enable\r\nconst TWSR_TWS_MASK = 0xf8; // TWI Status\r\nconst TWSR_TWPS1 = 0x2; // TWI Prescaler Bits\r\nconst TWSR_TWPS0 = 0x1; // TWI Prescaler Bits\r\nconst TWSR_TWPS_MASK = TWSR_TWPS1 | TWSR_TWPS0; // TWI Prescaler mask\r\nconst TWAR_TWA_MASK = 0xfe; //  TWI (Slave) Address Register\r\nconst TWAR_TWGCE = 0x1; // TWI General Call Recognition Enable Bit\r\nconst STATUS_BUS_ERROR = 0x0;\r\nconst STATUS_TWI_IDLE = 0xf8;\r\n// Master states\r\nconst STATUS_START = 0x08;\r\nconst STATUS_REPEATED_START = 0x10;\r\nconst STATUS_SLAW_ACK = 0x18;\r\nconst STATUS_SLAW_NACK = 0x20;\r\nconst STATUS_DATA_SENT_ACK = 0x28;\r\nconst STATUS_DATA_SENT_NACK = 0x30;\r\nconst STATUS_DATA_LOST_ARBITRATION = 0x38;\r\nconst STATUS_SLAR_ACK = 0x40;\r\nconst STATUS_SLAR_NACK = 0x48;\r\nconst STATUS_DATA_RECEIVED_ACK = 0x50;\r\nconst STATUS_DATA_RECEIVED_NACK = 0x58;\r\n// TODO: add slave states\r\n/* eslint-enable @typescript-eslint/no-unused-vars */\r\nexport const twiConfig = {\r\n    twiInterrupt: 0x30,\r\n    TWBR: 0xb8,\r\n    TWSR: 0xb9,\r\n    TWAR: 0xba,\r\n    TWDR: 0xbb,\r\n    TWCR: 0xbc,\r\n    TWAMR: 0xbd,\r\n};\r\n// A simple TWI Event Handler that sends a NACK for all events\r\nexport class NoopTWIEventHandler {\r\n    constructor(twi) {\r\n        this.twi = twi;\r\n    }\r\n    start() {\r\n        this.twi.completeStart();\r\n    }\r\n    stop() {\r\n        this.twi.completeStop();\r\n    }\r\n    connectToSlave() {\r\n        this.twi.completeConnect(false);\r\n    }\r\n    writeByte() {\r\n        this.twi.completeWrite(false);\r\n    }\r\n    readByte() {\r\n        this.twi.completeRead(0xff);\r\n    }\r\n}\r\nexport class AVRTWI {\r\n    constructor(cpu, config, freqHz) {\r\n        this.cpu = cpu;\r\n        this.config = config;\r\n        this.freqHz = freqHz;\r\n        this.eventHandler = new NoopTWIEventHandler(this);\r\n        this.busy = false;\r\n        // Interrupts\r\n        this.TWI = {\r\n            address: this.config.twiInterrupt,\r\n            flagRegister: this.config.TWCR,\r\n            flagMask: TWCR_TWINT,\r\n            enableRegister: this.config.TWCR,\r\n            enableMask: TWCR_TWIE,\r\n        };\r\n        this.updateStatus(STATUS_TWI_IDLE);\r\n        this.cpu.writeHooks[config.TWCR] = (value) => {\r\n            this.cpu.data[config.TWCR] = value;\r\n            const clearInt = value & TWCR_TWINT;\r\n            this.cpu.clearInterruptByFlag(this.TWI, value);\r\n            this.cpu.updateInterruptEnable(this.TWI, value);\r\n            const { status } = this;\r\n            if (clearInt && value & TWCR_TWEN && !this.busy) {\r\n                const twdrValue = this.cpu.data[this.config.TWDR];\r\n                this.cpu.addClockEvent(() => {\r\n                    if (value & TWCR_TWSTA) {\r\n                        this.busy = true;\r\n                        this.eventHandler.start(status !== STATUS_TWI_IDLE);\r\n                    }\r\n                    else if (value & TWCR_TWSTO) {\r\n                        this.busy = true;\r\n                        this.eventHandler.stop();\r\n                    }\r\n                    else if (status === STATUS_START || status === STATUS_REPEATED_START) {\r\n                        this.busy = true;\r\n                        this.eventHandler.connectToSlave(twdrValue >> 1, twdrValue & 0x1 ? false : true);\r\n                    }\r\n                    else if (status === STATUS_SLAW_ACK || status === STATUS_DATA_SENT_ACK) {\r\n                        this.busy = true;\r\n                        this.eventHandler.writeByte(twdrValue);\r\n                    }\r\n                    else if (status === STATUS_SLAR_ACK || status === STATUS_DATA_RECEIVED_ACK) {\r\n                        this.busy = true;\r\n                        const ack = !!(value & TWCR_TWEA);\r\n                        this.eventHandler.readByte(ack);\r\n                    }\r\n                }, 0);\r\n                return true;\r\n            }\r\n        };\r\n    }\r\n    get prescaler() {\r\n        switch (this.cpu.data[this.config.TWSR] & TWSR_TWPS_MASK) {\r\n            case 0:\r\n                return 1;\r\n            case 1:\r\n                return 4;\r\n            case 2:\r\n                return 16;\r\n            case 3:\r\n                return 64;\r\n        }\r\n        // We should never get here:\r\n        throw new Error('Invalid prescaler value!');\r\n    }\r\n    get sclFrequency() {\r\n        return this.freqHz / (16 + 2 * this.cpu.data[this.config.TWBR] * this.prescaler);\r\n    }\r\n    completeStart() {\r\n        this.busy = false;\r\n        this.updateStatus(this.status === STATUS_TWI_IDLE ? STATUS_START : STATUS_REPEATED_START);\r\n    }\r\n    completeStop() {\r\n        this.busy = false;\r\n        this.cpu.data[this.config.TWCR] &= ~TWCR_TWSTO;\r\n        this.updateStatus(STATUS_TWI_IDLE);\r\n    }\r\n    completeConnect(ack) {\r\n        this.busy = false;\r\n        if (this.cpu.data[this.config.TWDR] & 0x1) {\r\n            this.updateStatus(ack ? STATUS_SLAR_ACK : STATUS_SLAR_NACK);\r\n        }\r\n        else {\r\n            this.updateStatus(ack ? STATUS_SLAW_ACK : STATUS_SLAW_NACK);\r\n        }\r\n    }\r\n    completeWrite(ack) {\r\n        this.busy = false;\r\n        this.updateStatus(ack ? STATUS_DATA_SENT_ACK : STATUS_DATA_SENT_NACK);\r\n    }\r\n    completeRead(value) {\r\n        this.busy = false;\r\n        const ack = !!(this.cpu.data[this.config.TWCR] & TWCR_TWEA);\r\n        this.cpu.data[this.config.TWDR] = value;\r\n        this.updateStatus(ack ? STATUS_DATA_RECEIVED_ACK : STATUS_DATA_RECEIVED_NACK);\r\n    }\r\n    get status() {\r\n        return this.cpu.data[this.config.TWSR] & TWSR_TWS_MASK;\r\n    }\r\n    updateStatus(value) {\r\n        const { TWSR } = this.config;\r\n        this.cpu.data[TWSR] = (this.cpu.data[TWSR] & ~TWSR_TWS_MASK) | value;\r\n        this.cpu.setInterruptFlag(this.TWI);\r\n    }\r\n}\r\n", "/**\r\n * AVR-8 USART Peripheral\r\n * Part of AVR8js\r\n * Reference: http://ww1.microchip.com/downloads/en/DeviceDoc/ATmega48A-PA-88A-PA-168A-PA-328-P-DS-DS40002061A.pdf\r\n *\r\n * Copyright (C) 2019, 2020, 2021 Uri Shaked\r\n */\r\nexport const usart0Config = {\r\n    rxCompleteInterrupt: 0x24,\r\n    dataRegisterEmptyInterrupt: 0x26,\r\n    txCompleteInterrupt: 0x28,\r\n    UCSRA: 0xc0,\r\n    UCSRB: 0xc1,\r\n    UCSRC: 0xc2,\r\n    UBRRL: 0xc4,\r\n    UBRRH: 0xc5,\r\n    UDR: 0xc6,\r\n};\r\n/* eslint-disable @typescript-eslint/no-unused-vars */\r\n// Register bits:\r\nconst UCSRA_RXC = 0x80; // USART Receive Complete\r\nconst UCSRA_TXC = 0x40; // USART Transmit Complete\r\nconst UCSRA_UDRE = 0x20; // USART Data Register Empty\r\nconst UCSRA_FE = 0x10; // Frame Error\r\nconst UCSRA_DOR = 0x8; // Data OverRun\r\nconst UCSRA_UPE = 0x4; // USART Parity Error\r\nconst UCSRA_U2X = 0x2; // Double the USART Transmission Speed\r\nconst UCSRA_MPCM = 0x1; // Multi-processor Communication Mode\r\nconst UCSRA_CFG_MASK = UCSRA_U2X;\r\nconst UCSRB_RXCIE = 0x80; // RX Complete Interrupt Enable\r\nconst UCSRB_TXCIE = 0x40; // TX Complete Interrupt Enable\r\nconst UCSRB_UDRIE = 0x20; // USART Data Register Empty Interrupt Enable\r\nconst UCSRB_RXEN = 0x10; // Receiver Enable\r\nconst UCSRB_TXEN = 0x8; // Transmitter Enable\r\nconst UCSRB_UCSZ2 = 0x4; // Character Size 2\r\nconst UCSRB_RXB8 = 0x2; // Receive Data Bit 8\r\nconst UCSRB_TXB8 = 0x1; // Transmit Data Bit 8\r\nconst UCSRB_CFG_MASK = UCSRB_UCSZ2 | UCSRB_RXEN | UCSRB_TXEN;\r\nconst UCSRC_UMSEL1 = 0x80; // USART Mode Select 1\r\nconst UCSRC_UMSEL0 = 0x40; // USART Mode Select 0\r\nconst UCSRC_UPM1 = 0x20; // Parity Mode 1\r\nconst UCSRC_UPM0 = 0x10; // Parity Mode 0\r\nconst UCSRC_USBS = 0x8; // Stop Bit Select\r\nconst UCSRC_UCSZ1 = 0x4; // Character Size 1\r\nconst UCSRC_UCSZ0 = 0x2; // Character Size 0\r\nconst UCSRC_UCPOL = 0x1; // Clock Polarity\r\n/* eslint-enable @typescript-eslint/no-unused-vars */\r\nconst rxMasks = {\r\n    5: 0x1f,\r\n    6: 0x3f,\r\n    7: 0x7f,\r\n    8: 0xff,\r\n    9: 0xff,\r\n};\r\nexport class AVRUSART {\r\n    constructor(cpu, config, freqHz) {\r\n        this.cpu = cpu;\r\n        this.config = config;\r\n        this.freqHz = freqHz;\r\n        this.onByteTransmit = null;\r\n        this.onLineTransmit = null;\r\n        this.onRxComplete = null;\r\n        this.onConfigurationChange = null;\r\n        this.rxBusyValue = false;\r\n        this.rxByte = 0;\r\n        this.lineBuffer = '';\r\n        // Interrupts\r\n        this.RXC = {\r\n            address: this.config.rxCompleteInterrupt,\r\n            flagRegister: this.config.UCSRA,\r\n            flagMask: UCSRA_RXC,\r\n            enableRegister: this.config.UCSRB,\r\n            enableMask: UCSRB_RXCIE,\r\n            constant: true,\r\n        };\r\n        this.UDRE = {\r\n            address: this.config.dataRegisterEmptyInterrupt,\r\n            flagRegister: this.config.UCSRA,\r\n            flagMask: UCSRA_UDRE,\r\n            enableRegister: this.config.UCSRB,\r\n            enableMask: UCSRB_UDRIE,\r\n        };\r\n        this.TXC = {\r\n            address: this.config.txCompleteInterrupt,\r\n            flagRegister: this.config.UCSRA,\r\n            flagMask: UCSRA_TXC,\r\n            enableRegister: this.config.UCSRB,\r\n            enableMask: UCSRB_TXCIE,\r\n        };\r\n        this.reset();\r\n        this.cpu.writeHooks[config.UCSRA] = (value, oldValue) => {\r\n            var _a;\r\n            cpu.data[config.UCSRA] = value & (UCSRA_MPCM | UCSRA_U2X);\r\n            cpu.clearInterruptByFlag(this.TXC, value);\r\n            if ((value & UCSRA_CFG_MASK) !== (oldValue & UCSRA_CFG_MASK)) {\r\n                (_a = this.onConfigurationChange) === null || _a === void 0 ? void 0 : _a.call(this);\r\n            }\r\n            return true;\r\n        };\r\n        this.cpu.writeHooks[config.UCSRB] = (value, oldValue) => {\r\n            var _a;\r\n            cpu.updateInterruptEnable(this.RXC, value);\r\n            cpu.updateInterruptEnable(this.UDRE, value);\r\n            cpu.updateInterruptEnable(this.TXC, value);\r\n            if (value & UCSRB_RXEN && oldValue & UCSRB_RXEN) {\r\n                cpu.clearInterrupt(this.RXC);\r\n            }\r\n            if (value & UCSRB_TXEN && !(oldValue & UCSRB_TXEN)) {\r\n                // Enabling the transmission - mark UDR as empty\r\n                cpu.setInterruptFlag(this.UDRE);\r\n            }\r\n            cpu.data[config.UCSRB] = value;\r\n            if ((value & UCSRB_CFG_MASK) !== (oldValue & UCSRB_CFG_MASK)) {\r\n                (_a = this.onConfigurationChange) === null || _a === void 0 ? void 0 : _a.call(this);\r\n            }\r\n            return true;\r\n        };\r\n        this.cpu.writeHooks[config.UCSRC] = (value) => {\r\n            var _a;\r\n            cpu.data[config.UCSRC] = value;\r\n            (_a = this.onConfigurationChange) === null || _a === void 0 ? void 0 : _a.call(this);\r\n            return true;\r\n        };\r\n        this.cpu.readHooks[config.UDR] = () => {\r\n            var _a;\r\n            const mask = (_a = rxMasks[this.bitsPerChar]) !== null && _a !== void 0 ? _a : 0xff;\r\n            const result = this.rxByte & mask;\r\n            this.rxByte = 0;\r\n            this.cpu.clearInterrupt(this.RXC);\r\n            return result;\r\n        };\r\n        this.cpu.writeHooks[config.UDR] = (value) => {\r\n            if (this.onByteTransmit) {\r\n                this.onByteTransmit(value);\r\n            }\r\n            if (this.onLineTransmit) {\r\n                const ch = String.fromCharCode(value);\r\n                if (ch === '\\n') {\r\n                    this.onLineTransmit(this.lineBuffer);\r\n                    this.lineBuffer = '';\r\n                }\r\n                else {\r\n                    this.lineBuffer += ch;\r\n                }\r\n            }\r\n            this.cpu.addClockEvent(() => {\r\n                cpu.setInterruptFlag(this.UDRE);\r\n                cpu.setInterruptFlag(this.TXC);\r\n            }, this.cyclesPerChar);\r\n            this.cpu.clearInterrupt(this.TXC);\r\n            this.cpu.clearInterrupt(this.UDRE);\r\n        };\r\n        this.cpu.writeHooks[config.UBRRH] = (value) => {\r\n            var _a;\r\n            this.cpu.data[config.UBRRH] = value;\r\n            (_a = this.onConfigurationChange) === null || _a === void 0 ? void 0 : _a.call(this);\r\n            return true;\r\n        };\r\n        this.cpu.writeHooks[config.UBRRL] = (value) => {\r\n            var _a;\r\n            this.cpu.data[config.UBRRL] = value;\r\n            (_a = this.onConfigurationChange) === null || _a === void 0 ? void 0 : _a.call(this);\r\n            return true;\r\n        };\r\n    }\r\n    reset() {\r\n        this.cpu.data[this.config.UCSRA] = UCSRA_UDRE;\r\n        this.cpu.data[this.config.UCSRB] = 0;\r\n        this.cpu.data[this.config.UCSRC] = UCSRC_UCSZ1 | UCSRC_UCSZ0; // default: 8 bits per byte\r\n        this.rxBusyValue = false;\r\n        this.rxByte = 0;\r\n        this.lineBuffer = '';\r\n    }\r\n    get rxBusy() {\r\n        return this.rxBusyValue;\r\n    }\r\n    writeByte(value, immediate = false) {\r\n        var _a;\r\n        const { cpu } = this;\r\n        if (this.rxBusyValue || !this.rxEnable) {\r\n            return false;\r\n        }\r\n        if (immediate) {\r\n            this.rxByte = value;\r\n            cpu.setInterruptFlag(this.RXC);\r\n            (_a = this.onRxComplete) === null || _a === void 0 ? void 0 : _a.call(this);\r\n        }\r\n        else {\r\n            this.rxBusyValue = true;\r\n            cpu.addClockEvent(() => {\r\n                this.rxBusyValue = false;\r\n                this.writeByte(value, true);\r\n            }, this.cyclesPerChar);\r\n            return true;\r\n        }\r\n    }\r\n    get cyclesPerChar() {\r\n        const symbolsPerChar = 1 + this.bitsPerChar + this.stopBits + (this.parityEnabled ? 1 : 0);\r\n        return (this.UBRR + 1) * this.multiplier * symbolsPerChar;\r\n    }\r\n    get UBRR() {\r\n        const { UBRRH, UBRRL } = this.config;\r\n        return (this.cpu.data[UBRRH] << 8) | this.cpu.data[UBRRL];\r\n    }\r\n    get multiplier() {\r\n        return this.cpu.data[this.config.UCSRA] & UCSRA_U2X ? 8 : 16;\r\n    }\r\n    get rxEnable() {\r\n        return !!(this.cpu.data[this.config.UCSRB] & UCSRB_RXEN);\r\n    }\r\n    get txEnable() {\r\n        return !!(this.cpu.data[this.config.UCSRB] & UCSRB_TXEN);\r\n    }\r\n    get baudRate() {\r\n        return Math.floor(this.freqHz / (this.multiplier * (1 + this.UBRR)));\r\n    }\r\n    get bitsPerChar() {\r\n        const ucsz = ((this.cpu.data[this.config.UCSRC] & (UCSRC_UCSZ1 | UCSRC_UCSZ0)) >> 1) |\r\n            (this.cpu.data[this.config.UCSRB] & UCSRB_UCSZ2);\r\n        switch (ucsz) {\r\n            case 0:\r\n                return 5;\r\n            case 1:\r\n                return 6;\r\n            case 2:\r\n                return 7;\r\n            case 3:\r\n                return 8;\r\n            default: // 4..6 are reserved\r\n            case 7:\r\n                return 9;\r\n        }\r\n    }\r\n    get stopBits() {\r\n        return this.cpu.data[this.config.UCSRC] & UCSRC_USBS ? 2 : 1;\r\n    }\r\n    get parityEnabled() {\r\n        return this.cpu.data[this.config.UCSRC] & UCSRC_UPM1 ? true : false;\r\n    }\r\n    get parityOdd() {\r\n        return this.cpu.data[this.config.UCSRC] & UCSRC_UPM0 ? true : false;\r\n    }\r\n}\r\n", "const USICR = 0x2d;\r\nconst USISR = 0x2e;\r\nconst USIDR = 0x2f;\r\nconst USIBR = 0x30;\r\n// USISR bits\r\nconst USICNT_MASK = 0xf;\r\nconst USIDC = 1 << 4;\r\nconst USIPF = 1 << 5;\r\nconst USIOIF = 1 << 6;\r\nconst USISIF = 1 << 7;\r\n// USICR bits\r\nconst USITC = 1 << 0;\r\nconst USICLK = 1 << 1;\r\nconst USICS0 = 1 << 2;\r\nconst USICS1 = 1 << 3;\r\nconst USIWM0 = 1 << 4;\r\nconst USIWM1 = 1 << 5;\r\nconst USIOIE = 1 << 6;\r\nconst USISIE = 1 << 7;\r\nexport class AVRUSI {\r\n    constructor(cpu, port, portPin, dataPin, clockPin) {\r\n        // Interrupts\r\n        this.START = {\r\n            address: 0xd,\r\n            flagRegister: USISR,\r\n            flagMask: USISIF,\r\n            enableRegister: USICR,\r\n            enableMask: USISIE,\r\n        };\r\n        this.OVF = {\r\n            address: 0xe,\r\n            flagRegister: USISR,\r\n            flagMask: USIOIF,\r\n            enableRegister: USICR,\r\n            enableMask: USIOIE,\r\n        };\r\n        const PIN = portPin;\r\n        const PORT = PIN + 2;\r\n        port.addListener((value) => {\r\n            const twoWire = (cpu.data[USICR] & USIWM1) === USIWM1;\r\n            if (twoWire) {\r\n                if (value & (1 << clockPin) && !(value & (1 << dataPin))) {\r\n                    // Start condition detected\r\n                    cpu.setInterruptFlag(this.START);\r\n                }\r\n                if (value & (1 << clockPin) && value & (1 << dataPin)) {\r\n                    // Stop condition detected\r\n                    cpu.data[USISR] |= USIPF;\r\n                }\r\n            }\r\n        });\r\n        const updateOutput = () => {\r\n            const oldValue = cpu.data[PORT];\r\n            const newValue = cpu.data[USIDR] & 0x80 ? oldValue | (1 << dataPin) : oldValue & ~(1 << dataPin);\r\n            cpu.writeHooks[PORT](newValue, oldValue, PORT, 0xff);\r\n            if (newValue & 0x80 && !(cpu.data[PIN] & 0x80)) {\r\n                cpu.data[USISR] |= USIDC; // Shout output HIGH (pulled-up), but input is LOW\r\n            }\r\n            else {\r\n                cpu.data[USISR] &= ~USIDC;\r\n            }\r\n        };\r\n        const count = () => {\r\n            const counter = (cpu.data[USISR] + 1) & USICNT_MASK;\r\n            cpu.data[USISR] = (cpu.data[USISR] & ~USICNT_MASK) | counter;\r\n            if (!counter) {\r\n                cpu.data[USIBR] = cpu.data[USIDR];\r\n                cpu.setInterruptFlag(this.OVF);\r\n            }\r\n        };\r\n        const shift = (inputValue) => {\r\n            cpu.data[USIDR] = (cpu.data[USIDR] << 1) | inputValue;\r\n            updateOutput();\r\n        };\r\n        cpu.writeHooks[USIDR] = (value) => {\r\n            cpu.data[USIDR] = value;\r\n            updateOutput();\r\n            return true;\r\n        };\r\n        cpu.writeHooks[USISR] = (value) => {\r\n            const writeClearMask = USISIF | USIOIF | USIPF;\r\n            cpu.data[USISR] = (cpu.data[USISR] & writeClearMask & ~value) | (value & 0xf);\r\n            cpu.clearInterruptByFlag(this.START, value);\r\n            cpu.clearInterruptByFlag(this.OVF, value);\r\n            return true;\r\n        };\r\n        cpu.writeHooks[USICR] = (value) => {\r\n            cpu.data[USICR] = value & ~(USICLK | USITC);\r\n            cpu.updateInterruptEnable(this.START, value);\r\n            cpu.updateInterruptEnable(this.OVF, value);\r\n            const clockSrc = value & ((USICS1 | USICS0) >> 2);\r\n            const mode = value & ((USIWM1 | USIWM0) >> 4);\r\n            const usiClk = value & USICLK;\r\n            port.openCollector = mode >= 2 ? 1 << dataPin : 0;\r\n            const inputValue = cpu.data[PIN] & (1 << dataPin) ? 1 : 0;\r\n            if (usiClk && !clockSrc) {\r\n                shift(inputValue);\r\n                count();\r\n            }\r\n            if (value & USITC) {\r\n                cpu.writeHooks[PIN](1 << clockPin, cpu.data[PIN], PIN, 0xff);\r\n                const newValue = cpu.data[PIN] & (1 << clockPin);\r\n                if (usiClk && (clockSrc === 2 || clockSrc === 3)) {\r\n                    if (clockSrc === 2 && newValue) {\r\n                        shift(inputValue);\r\n                    }\r\n                    if (clockSrc === 3 && !newValue) {\r\n                        shift(inputValue);\r\n                    }\r\n                    count();\r\n                }\r\n                return true;\r\n            }\r\n        };\r\n    }\r\n}\r\n", "/**\r\n * AVR8 Watchdog Timer\r\n * Part of AVR8js\r\n * Reference: http://ww1.microchip.com/downloads/en/DeviceDoc/ATmega48A-PA-88A-PA-168A-PA-328-P-DS-DS40002061A.pdf\r\n *\r\n * Copyright (C) 2021 Uri Shaked\r\n */\r\n// Register bits:\r\nconst MCUSR_WDRF = 0x8; //  Watchdog System Reset Flag\r\nconst WDTCSR_WDIF = 0x80;\r\nconst WDTCSR_WDIE = 0x40;\r\nconst WDTCSR_WDP3 = 0x20;\r\nconst WDTCSR_WDCE = 0x10; // Watchdog Change Enable\r\nconst WDTCSR_WDE = 0x8;\r\nconst WDTCSR_WDP2 = 0x4;\r\nconst WDTCSR_WDP1 = 0x2;\r\nconst WDTCSR_WDP0 = 0x1;\r\nconst WDTCSR_WDP210 = WDTCSR_WDP2 | WDTCSR_WDP1 | WDTCSR_WDP0;\r\nconst WDTCSR_PROTECT_MASK = WDTCSR_WDE | WDTCSR_WDP3 | WDTCSR_WDP210;\r\nexport const watchdogConfig = {\r\n    watchdogInterrupt: 0x0c,\r\n    MCUSR: 0x54,\r\n    WDTCSR: 0x60,\r\n};\r\nexport class AVRWatchdog {\r\n    constructor(cpu, config, clock) {\r\n        this.cpu = cpu;\r\n        this.config = config;\r\n        this.clock = clock;\r\n        this.clockFrequency = 128000;\r\n        /**\r\n         * Used to keep track on the last write to WDCE. Once written, the WDE/WDP* bits can be changed.\r\n         */\r\n        this.changeEnabledCycles = 0;\r\n        this.watchdogTimeout = 0;\r\n        this.enabledValue = false;\r\n        this.scheduled = false;\r\n        // Interrupts\r\n        this.Watchdog = {\r\n            address: this.config.watchdogInterrupt,\r\n            flagRegister: this.config.WDTCSR,\r\n            flagMask: WDTCSR_WDIF,\r\n            enableRegister: this.config.WDTCSR,\r\n            enableMask: WDTCSR_WDIE,\r\n        };\r\n        this.checkWatchdog = () => {\r\n            if (this.enabled && this.cpu.cycles >= this.watchdogTimeout) {\r\n                // Watchdog timed out!\r\n                const wdtcsr = this.cpu.data[this.config.WDTCSR];\r\n                if (wdtcsr & WDTCSR_WDIE) {\r\n                    this.cpu.setInterruptFlag(this.Watchdog);\r\n                }\r\n                if (wdtcsr & WDTCSR_WDE) {\r\n                    if (wdtcsr & WDTCSR_WDIE) {\r\n                        this.cpu.data[this.config.WDTCSR] &= ~WDTCSR_WDIE;\r\n                    }\r\n                    else {\r\n                        this.cpu.reset();\r\n                        this.scheduled = false;\r\n                        this.cpu.data[this.config.MCUSR] |= MCUSR_WDRF;\r\n                        return;\r\n                    }\r\n                }\r\n                this.resetWatchdog();\r\n            }\r\n            if (this.enabled) {\r\n                this.scheduled = true;\r\n                this.cpu.addClockEvent(this.checkWatchdog, this.watchdogTimeout - this.cpu.cycles);\r\n            }\r\n            else {\r\n                this.scheduled = false;\r\n            }\r\n        };\r\n        const { WDTCSR } = config;\r\n        this.cpu.onWatchdogReset = () => {\r\n            this.resetWatchdog();\r\n        };\r\n        cpu.writeHooks[WDTCSR] = (value, oldValue) => {\r\n            if (value & WDTCSR_WDCE && value & WDTCSR_WDE) {\r\n                this.changeEnabledCycles = this.cpu.cycles + 4;\r\n                value = value & ~WDTCSR_PROTECT_MASK;\r\n            }\r\n            else {\r\n                if (this.cpu.cycles >= this.changeEnabledCycles) {\r\n                    value = (value & ~WDTCSR_PROTECT_MASK) | (oldValue & WDTCSR_PROTECT_MASK);\r\n                }\r\n                this.enabledValue = !!(value & WDTCSR_WDE || value & WDTCSR_WDIE);\r\n                this.cpu.data[WDTCSR] = value;\r\n            }\r\n            if (this.enabled) {\r\n                this.resetWatchdog();\r\n            }\r\n            if (this.enabled && !this.scheduled) {\r\n                this.cpu.addClockEvent(this.checkWatchdog, this.watchdogTimeout - this.cpu.cycles);\r\n            }\r\n            this.cpu.clearInterruptByFlag(this.Watchdog, value);\r\n            return true;\r\n        };\r\n    }\r\n    resetWatchdog() {\r\n        const cycles = Math.floor((this.clock.frequency / this.clockFrequency) * this.prescaler);\r\n        this.watchdogTimeout = this.cpu.cycles + cycles;\r\n    }\r\n    get enabled() {\r\n        return this.enabledValue;\r\n    }\r\n    /**\r\n     * The base clock frequency is 128KHz. Thus, a prescaler of 2048 gives 16ms timeout.\r\n     */\r\n    get prescaler() {\r\n        const wdtcsr = this.cpu.data[this.config.WDTCSR];\r\n        const value = ((wdtcsr & WDTCSR_WDP3) >> 2) | (wdtcsr & WDTCSR_WDP210);\r\n        return 2048 << value;\r\n    }\r\n}\r\n"],
  "mappings": "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",
  "names": ["ADCReference", "ADCMuxInputType", "PinState", "PinOverrideMode", "InterruptMode", "ExternalClockMode", "TimerMode", "TOVUpdateMode", "OCRUpdateMode", "cpu"]
}
